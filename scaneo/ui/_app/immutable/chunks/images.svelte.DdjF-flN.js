import{p as i}from"./proxy.BT_Zq6Rg.js";import{N as g,g as c,o as n}from"./runtime.B6coxiGD.js";import{f,P as m}from"./fetcher.BMDzGJ_8.js";const w=async t=>{const e=`${m}/annotations/${t}`;return f(e)};async function y(t,e){const u=`${m}/annotations/classification`;return f(u,"POST",{label:t,imageId:e})}async function $(t,e,u){const d=`${m}/annotations/detection`;return f(d,"POST",{bb:t,label:e,imageId:u})}async function p(t,e,u){const d=`${m}/annotations/segmentation`;return f(d,"POST",{layer_data:t,label:e,imageId:u})}const A=async t=>{const e=`${m}/annotations/${t}`;return f(e,"DELETE")},E=async t=>{const e=`${m}/geojson/save`;return f(e,"POST",{campaignId:t})};async function P(t,e){const u=`${m}/annotations/detection/${t}`;return f(u,"PUT",{bb:e})}function _(){let t=g(i([])),e=g(!0),u=g(null),d=g(null);return{get data(){return c(t)},get loading(){return c(e)},get error(){return c(u)},get current(){return c(d)},set current(r){n(d,i(r))},retrieve:async r=>{n(e,!0);const{data:a,error:o}=await w(r);return o&&n(u,i(o.message)),n(t,i(a)),n(e,!1),a},createClassification:async(r,a)=>{const{data:o,error:l}=await y(r,a);if(l)throw new Error(l.message);console.log(c(t),o),c(t).find(s=>s.id===o.id)?n(t,i(c(t).map(s=>s.id===o.id?o:s))):n(t,i([o,...c(t)]))},createDetection:async(r,a,o)=>{const{data:l,error:s}=await $(r,a,o);if(s)throw new Error(s.message);return n(t,i([l,...c(t)])),l},updateDetection:async(r,a)=>{const{data:o,error:l}=await P(r,a);if(l)throw new Error(l.message);n(t,i(c(t).map(s=>s.id===r?{...s,bb:a}:s)))},createSegmentation:async(r,a,o)=>{const{data:l,error:s}=await p(r,a,o);if(s)throw new Error(s.message);return n(t,i([l,...c(t)])),l},delete:async r=>{const{error:a}=await A(r);if(a)throw new Error(a.message);n(t,i(c(t).filter(o=>o.id!==r)))},save:async r=>{const{error:a}=await E(r);if(a)throw new Error(a.message)},reset:()=>{n(t,i([])),n(e,!0),n(u,null),n(d,null)}}}const I=_(),h=async t=>{const e=`${m}/images/${t}`;return f(e)};function v(){let t=g(i([])),e=g(!0),u=g(null),d=g(null);return{get data(){return c(t)},get loading(){return c(e)},get error(){return c(u)},get current(){return c(d)},set current(r){n(d,i(r))},retrieve:async r=>{n(e,!0);const{data:a,error:o}=await h(r);o&&n(u,i(o.message)),n(t,i(a)),n(e,!1)},zoom:(r,a)=>{const o=L.latLng(r[1],r[0]),l=L.latLng(r[3],r[2]),s=L.latLngBounds(o,l);a.fitBounds(s)},reset:()=>{n(t,i([])),n(e,!0),n(u,null),n(d,null)}}}const O=v();export{I as a,O as i};
