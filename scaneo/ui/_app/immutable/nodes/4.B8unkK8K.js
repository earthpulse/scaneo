import{a as A,t as E}from"../chunks/disclose-version.hHXjza9X.js";import{e as w,g as s,b as u,p as ma,u as C,t as W,a as ua,s as t,c as a,r as e,d as X}from"../chunks/runtime.B40kIuYm.js";import{s as _}from"../chunks/render.CM3wPBfR.js";import{i as ga}from"../chunks/if.BU02RLSO.js";import{p as g}from"../chunks/proxy.B3-__M_J.js";import{s as fa,a as _a,p as xa}from"../chunks/stores.Cj5JbFE9.js";import{g as ba}from"../chunks/entry.Q-iAUPhB.js";import{c as m}from"../chunks/campaigns.svelte.D1s0rgbZ.js";import{m as wa}from"../chunks/models.svelte.CvpcYXkj.js";import{f as Y,P as Z}from"../chunks/fetcher.BMDzGJ_8.js";import{L as ha,l as D}from"../chunks/Labels.DQjNQa7H.js";import{L as ya,E as ka}from"../chunks/ExportBtn.BY8iao7l.js";import{D as La}from"../chunks/DeleteBtn.BX9MUm6E.js";import{d as $a}from"../chunks/events.DTvxUH_b.js";import{M as Ma}from"../chunks/ModelSelector.BGNA58DE.js";const Ia=async(i,n="campaigns")=>{const o=`${Z}/${n}/${i}/label_mappings`;return Y(o)},Ba=async(i,n)=>{console.log("data",n);const o=`${Z}/campaigns/${i}/label_mappings`;return Y(o,"POST",n)};function Pa(){let i=w(g([])),n=w(!0),o=w(null);return{get data(){return s(i)},set data(v){u(i,g(v))},get loading(){return s(n)},get error(){return s(o)},retrieve:async(v,l="campaigns")=>{u(n,!0);const{data:d,error:f}=await Ia(v,l);f&&u(o,g(f.message)),u(i,g(d)),u(n,!1)},update:async(v,l)=>{const{data:d,error:f}=await Ba(v,{data:l});if(f)throw new Error(f)}}}const U=Pa();var Ca=E('<button class="btn btn-outline btn-sm tooltip flex items-center" data-tip="Update"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 0l2.586 2.586a2 2 0 010 2.828l-8.083 8.083"></path></svg></button>');function Da(i,n){var o=Ca();o.__click=function(...v){var l;(l=n.onclick)==null||l.apply(this,v)},A(i,o)}$a(["click"]);var Ua=E('<p class="mt-2 text-gray-600"> </p>'),Aa=E('<div class="container mx-auto p-6"><div class="mb-8"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold text-gray-800"> </h1> <div class="flex flex-row gap-3"><!> <!> <!> <!></div></div> <!></div> <div class="bg-white rounded-lg shadow-sm p-6 border border-1"><div class="grid grid-cols-1 gap-4"><div class="border-b pb-4"><h2 class="text-sm font-semibold text-gray-600 uppercase mb-2">Details</h2> <div class="space-y-3"><div class="flex"><span class="font-medium w-32">Name:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Description:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Images:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Annotations:</span> <span class="text-gray-700"> </span></div> <div class="flex flex-col"><span class="font-medium w-32">Labels:</span> <div><!></div></div> <div class="flex flex-col"><!></div></div></div></div></div></div>');function Va(i,n){ma(n,!0);const o=fa(),v=()=>_a(xa,"$page",o);let l=w(g({})),d=w("");C(()=>{u(d,g(v().url.searchParams.get("id")))}),C(()=>{m.retrieveOne(s(d)),wa.retrieve(),D.retrieve(s(d)),U.retrieve(s(d))}),C(()=>{var r;u(l,g((r=U.data)==null?void 0:r.reduce((p,c)=>{var x,b;return p[c.modelId]||(p[c.modelId]={}),p[c.modelId][(b=(x=D.data)==null?void 0:x.find(va=>va.id==c.labelId))==null?void 0:b.name]=c.output_index,p},{})))});const f=()=>{confirm("Are you sure you want to delete this campaign?")&&(m.delete(s(d)),ba("/campaigns"))},aa=()=>{console.log("update sources")},j=async()=>{try{await U.update(s(d),s(l))}catch(r){alert(r)}};var h=Aa(),y=a(h),k=a(y),L=a(k),ea=a(L);e(L);var N=t(L,2),O=a(N),ta=X(()=>`/campaigns/label?id=${s(d)}`);ya(O,{get link(){return s(ta)}});var S=t(O,2),ra=X(()=>`/campaigns/export?id=${s(d)}`);ka(S,{get link(){return s(ra)}});var H=t(S,2);Da(H,{onclick:aa});var sa=t(H,2);La(sa,{onclick:f}),e(N),e(k);var na=t(k,2);ga(na,()=>{var r;return(r=m.current)==null?void 0:r.description},r=>{var p=Ua(),c=a(p);e(p),W(()=>_(c,m.current.description)),A(r,p)}),e(y);var R=t(y,2),T=a(R),q=a(T),z=t(a(q),2),$=a(z),F=t(a($),2),ia=a(F);e(F),e($);var M=t($,2),G=t(a(M),2),oa=a(G);e(G),e(M);var I=t(M,2),J=t(a(I),2),la=a(J);e(J),e(I);var B=t(I,2),K=t(a(B),2),da=a(K);e(K),e(B);var P=t(B,2),Q=t(a(P),2),pa=a(Q);ha(pa,{}),e(Q),e(P);var V=t(P,2),ca=a(V);Ma(ca,{get labels(){return D.data},get labelMappings(){return s(l)},set labelMappings(r){u(l,g(r))},onclick:j,ondelete:j}),e(V),e(z),e(q),e(T),e(R),e(h),W(()=>{var r,p,c,x,b;_(ea,((r=m.current)==null?void 0:r.name)||"Loading campaign..."),_(ia,((p=m.current)==null?void 0:p.name)||"-"),_(oa,((c=m.current)==null?void 0:c.description)||"No description provided"),_(la,(x=m.current)==null?void 0:x.image_count),_(da,(b=m.current)==null?void 0:b.annotation_count)}),A(i,h),ua()}export{Va as component};
