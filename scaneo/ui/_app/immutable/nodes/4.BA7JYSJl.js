import{a as A,t as N}from"../chunks/disclose-version.DymP2m3X.js";import{e as w,g as s,b as u,p as ma,u as E,t as X,a as ua,s as t,c as a,r as e,d as Y}from"../chunks/runtime.cJOh_ioU.js";import{s as _}from"../chunks/render.Gnl0czpM.js";import{i as ga}from"../chunks/if.Bhj5v8Zz.js";import{p as g}from"../chunks/proxy.D4aqs5o-.js";import{s as fa,a as _a,p as ba}from"../chunks/stores.BRHuMDzc.js";import{g as xa}from"../chunks/entry.CmmDslp3.js";import{c as m}from"../chunks/campaigns.svelte.B65SHqyX.js";import{m as wa}from"../chunks/models.svelte.BY3bXU-h.js";import{b as h,f as Z}from"../chunks/fetcher.C3wkiN9W.js";import{L as ha,l as U}from"../chunks/Labels.BbpGJPmO.js";import{L as ya}from"../chunks/LabelBtn.B6O-Argd.js";import{E as ka}from"../chunks/ExportBtn.BkRmAOCz.js";import{D as $a}from"../chunks/DeleteBtn.BVsdhktI.js";import{d as La}from"../chunks/events.BOQTMbzA.js";import{M as Ma}from"../chunks/ModelSelector.GyrvVA0d.js";const Ia=async(i,n="campaigns")=>{const o=`${h.api_url}/_${n}/${i}/label_mappings`;return Z(o)},Ba=async(i,n)=>{const o=`${h.api_url}/_campaigns/${i}/label_mappings`;return Z(o,"POST",n)};function Da(){let i=w(g([])),n=w(!0),o=w(null);return{get data(){return s(i)},set data(v){u(i,g(v))},get loading(){return s(n)},get error(){return s(o)},retrieve:async(v,l="campaigns")=>{u(n,!0);const{data:d,error:f}=await Ia(v,l);f&&u(o,g(f.message)),u(i,g(d)),u(n,!1)},update:async(v,l)=>{const{data:d,error:f}=await Ba(v,{data:l});if(f)throw new Error(f)}}}const j=Da();var Ca=N('<button class="btn btn-outline btn-sm tooltip flex items-center p-2" data-tip="Update"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 0l2.586 2.586a2 2 0 010 2.828l-8.083 8.083"></path></svg></button>');function Ea(i,n){var o=Ca();o.__click=function(...v){var l;(l=n.onclick)==null||l.apply(this,v)},A(i,o)}La(["click"]);var Ua=N('<p class="mt-2 text-gray-600"> </p>'),ja=N('<div class="container mx-auto p-6"><div class="mb-8"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold text-gray-800"> </h1> <div class="flex flex-row gap-3"><!> <!> <!> <!></div></div> <!></div> <div class="bg-white rounded-lg shadow-sm p-6 border border-1"><div class="grid grid-cols-1 gap-4"><div class="border-b pb-4"><h2 class="text-sm font-semibold text-gray-600 uppercase mb-2">Details</h2> <div class="space-y-3"><div class="flex"><span class="font-medium w-32">Name:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Description:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Images:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Annotations:</span> <span class="text-gray-700"> </span></div> <div class="flex flex-col"><span class="font-medium w-32">Labels:</span> <div><!></div></div> <div class="flex flex-col"><!></div></div></div></div></div></div>');function Wa(i,n){ma(n,!0);const o=fa(),v=()=>_a(ba,"$page",o);let l=w(g({})),d=w("");E(()=>{u(d,g(v().url.searchParams.get("id")))}),E(()=>{m.retrieveOne(s(d)),wa.retrieve(),U.retrieve(s(d)),j.retrieve(s(d))}),E(()=>{var r;u(l,g((r=j.data)==null?void 0:r.reduce((p,c)=>{var b,x;return p[c.modelId]||(p[c.modelId]={}),p[c.modelId][(x=(b=U.data)==null?void 0:b.find(va=>va.id==c.labelId))==null?void 0:x.name]=c.output_index,p},{})))});const f=()=>{confirm("Are you sure you want to delete this campaign?")&&(m.delete(s(d)),xa(`${h.url}/campaigns`))},aa=()=>{console.log("update sources")},O=async()=>{try{await j.update(s(d),s(l))}catch(r){alert(r)}};var y=ja(),k=a(y),$=a(k),L=a($),ea=a(L);e(L);var P=t(L,2),S=a(P),ta=Y(()=>`${h.url}/campaigns/label?id=${s(d)}`);ya(S,{get link(){return s(ta)}});var H=t(S,2),ra=Y(()=>`${h.url}/campaigns/export?id=${s(d)}`);ka(H,{get link(){return s(ra)}});var T=t(H,2);Ea(T,{onclick:aa});var sa=t(T,2);$a(sa,{onclick:f}),e(P),e($);var ia=t($,2);ga(ia,()=>{var r;return(r=m.current)==null?void 0:r.description},r=>{var p=Ua(),c=a(p);e(p),X(()=>_(c,m.current.description)),A(r,p)}),e(k);var q=t(k,2),z=a(q),F=a(z),G=t(a(F),2),M=a(G),J=t(a(M),2),na=a(J);e(J),e(M);var I=t(M,2),K=t(a(I),2),oa=a(K);e(K),e(I);var B=t(I,2),Q=t(a(B),2),la=a(Q);e(Q),e(B);var D=t(B,2),R=t(a(D),2),da=a(R);e(R),e(D);var C=t(D,2),V=t(a(C),2),pa=a(V);ha(pa,{}),e(V),e(C);var W=t(C,2),ca=a(W);Ma(ca,{get labels(){return U.data},get labelMappings(){return s(l)},set labelMappings(r){u(l,g(r))},onclick:O,ondelete:O}),e(W),e(G),e(F),e(z),e(q),e(y),X(()=>{var r,p,c,b,x;_(ea,((r=m.current)==null?void 0:r.name)||"Loading campaign..."),_(na,((p=m.current)==null?void 0:p.name)||"-"),_(oa,((c=m.current)==null?void 0:c.description)||"No description provided"),_(la,(b=m.current)==null?void 0:b.image_count),_(da,(x=m.current)==null?void 0:x.annotation_count)}),A(i,y),ua()}export{Wa as component};
