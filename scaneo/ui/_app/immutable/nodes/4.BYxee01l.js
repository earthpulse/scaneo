import{a as j,t as A}from"../chunks/disclose-version.hHXjza9X.js";import{e as w,g as s,b as u,p as ma,u as C,t as W,a as ua,s as t,c as a,r as e,d as X}from"../chunks/runtime.B40kIuYm.js";import{s as _}from"../chunks/render.CM3wPBfR.js";import{i as ga}from"../chunks/if.BU02RLSO.js";import{p as g}from"../chunks/proxy.B3-__M_J.js";import{s as fa,a as _a,p as ba}from"../chunks/stores.CgaZXNqg.js";import{g as xa}from"../chunks/entry.DW3aDrJh.js";import{c as m}from"../chunks/campaigns.svelte.DKQrOMLH.js";import{m as wa}from"../chunks/models.svelte.BQfzCjcw.js";import{b as Y,f as Z}from"../chunks/fetcher.CybOVi2G.js";import{L as ha,l as E}from"../chunks/Labels.BOnFLF1m.js";import{L as ya,E as ka}from"../chunks/ExportBtn.BY8iao7l.js";import{D as $a}from"../chunks/DeleteBtn.BX9MUm6E.js";import{d as La}from"../chunks/events.DTvxUH_b.js";import{M as Ma}from"../chunks/ModelSelector.D9c5pUSW.js";const Ia=async(i,n="campaigns")=>{const o=`${Y.url}/${n}/${i}/label_mappings`;return Z(o)},Ba=async(i,n)=>{console.log("data",n);const o=`${Y.url}/campaigns/${i}/label_mappings`;return Z(o,"POST",n)};function Da(){let i=w(g([])),n=w(!0),o=w(null);return{get data(){return s(i)},set data(v){u(i,g(v))},get loading(){return s(n)},get error(){return s(o)},retrieve:async(v,l="campaigns")=>{u(n,!0);const{data:d,error:f}=await Ia(v,l);f&&u(o,g(f.message)),u(i,g(d)),u(n,!1)},update:async(v,l)=>{const{data:d,error:f}=await Ba(v,{data:l});if(f)throw new Error(f)}}}const U=Da();var Ca=A('<button class="btn btn-outline btn-sm tooltip flex items-center" data-tip="Update"><svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 0l2.586 2.586a2 2 0 010 2.828l-8.083 8.083"></path></svg></button>');function Ea(i,n){var o=Ca();o.__click=function(...v){var l;(l=n.onclick)==null||l.apply(this,v)},j(i,o)}La(["click"]);var Ua=A('<p class="mt-2 text-gray-600"> </p>'),ja=A('<div class="container mx-auto p-6"><div class="mb-8"><div class="flex justify-between items-center"><h1 class="text-2xl font-bold text-gray-800"> </h1> <div class="flex flex-row gap-3"><!> <!> <!> <!></div></div> <!></div> <div class="bg-white rounded-lg shadow-sm p-6 border border-1"><div class="grid grid-cols-1 gap-4"><div class="border-b pb-4"><h2 class="text-sm font-semibold text-gray-600 uppercase mb-2">Details</h2> <div class="space-y-3"><div class="flex"><span class="font-medium w-32">Name:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Description:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Images:</span> <span class="text-gray-700"> </span></div> <div class="flex"><span class="font-medium w-32">Annotations:</span> <span class="text-gray-700"> </span></div> <div class="flex flex-col"><span class="font-medium w-32">Labels:</span> <div><!></div></div> <div class="flex flex-col"><!></div></div></div></div></div></div>');function Va(i,n){ma(n,!0);const o=fa(),v=()=>_a(ba,"$page",o);let l=w(g({})),d=w("");C(()=>{u(d,g(v().url.searchParams.get("id")))}),C(()=>{m.retrieveOne(s(d)),wa.retrieve(),E.retrieve(s(d)),U.retrieve(s(d))}),C(()=>{var r;u(l,g((r=U.data)==null?void 0:r.reduce((p,c)=>{var b,x;return p[c.modelId]||(p[c.modelId]={}),p[c.modelId][(x=(b=E.data)==null?void 0:b.find(va=>va.id==c.labelId))==null?void 0:x.name]=c.output_index,p},{})))});const f=()=>{confirm("Are you sure you want to delete this campaign?")&&(m.delete(s(d)),xa("/campaigns"))},aa=()=>{console.log("update sources")},N=async()=>{try{await U.update(s(d),s(l))}catch(r){alert(r)}};var h=ja(),y=a(h),k=a(y),$=a(k),ea=a($);e($);var O=t($,2),P=a(O),ta=X(()=>`/campaigns/label?id=${s(d)}`);ya(P,{get link(){return s(ta)}});var S=t(P,2),ra=X(()=>`/campaigns/export?id=${s(d)}`);ka(S,{get link(){return s(ra)}});var H=t(S,2);Ea(H,{onclick:aa});var sa=t(H,2);$a(sa,{onclick:f}),e(O),e(k);var na=t(k,2);ga(na,()=>{var r;return(r=m.current)==null?void 0:r.description},r=>{var p=Ua(),c=a(p);e(p),W(()=>_(c,m.current.description)),j(r,p)}),e(y);var T=t(y,2),q=a(T),z=a(q),F=t(a(z),2),L=a(F),G=t(a(L),2),ia=a(G);e(G),e(L);var M=t(L,2),J=t(a(M),2),oa=a(J);e(J),e(M);var I=t(M,2),K=t(a(I),2),la=a(K);e(K),e(I);var B=t(I,2),Q=t(a(B),2),da=a(Q);e(Q),e(B);var D=t(B,2),R=t(a(D),2),pa=a(R);ha(pa,{}),e(R),e(D);var V=t(D,2),ca=a(V);Ma(ca,{get labels(){return E.data},get labelMappings(){return s(l)},set labelMappings(r){u(l,g(r))},onclick:N,ondelete:N}),e(V),e(F),e(z),e(q),e(T),e(h),W(()=>{var r,p,c,b,x;_(ea,((r=m.current)==null?void 0:r.name)||"Loading campaign..."),_(ia,((p=m.current)==null?void 0:p.name)||"-"),_(oa,((c=m.current)==null?void 0:c.description)||"No description provided"),_(la,(b=m.current)==null?void 0:b.image_count),_(da,(x=m.current)==null?void 0:x.annotation_count)}),j(i,h),ua()}export{Va as component};
