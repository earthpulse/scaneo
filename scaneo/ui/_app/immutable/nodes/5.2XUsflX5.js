import{a as i,t as m,c as G}from"../chunks/disclose-version.hHXjza9X.js";import{p as J,e as h,u as W,f as H,g as e,b as u,a as Q,s as a,c as o,r as l,d as se,t as $}from"../chunks/runtime.B40kIuYm.js";import{s as Y}from"../chunks/render.CM3wPBfR.js";import{i as M}from"../chunks/if.BU02RLSO.js";import{r as R,s as ie,a as ne}from"../chunks/attributes.faLUl4vZ.js";import{s as B}from"../chunks/class.ysGxxhcu.js";import{d as X,e as de}from"../chunks/events.DTvxUH_b.js";import{b as z}from"../chunks/input.CHcNizJA.js";import{p as N}from"../chunks/proxy.B3-__M_J.js";import{c as g}from"../chunks/campaigns.svelte.D1s0rgbZ.js";import{p as ce}from"../chunks/plugins.svelte.BB7JkIoQ.js";import{e as Z,i as ee}from"../chunks/each.DvJ5DvNT.js";import{b as pe,P as ue,D as me}from"../chunks/DeleteOutline.CIoqQZFN.js";import{p as te}from"../chunks/props.BJTpJmXG.js";import{s as ve,M as be}from"../chunks/ModelSelector.BGNA58DE.js";var fe=m('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="form-control"><label class="label font-medium mb-1">S3 URL</label> <input type="text" class="input input-bordered w-full" placeholder="Enter S3 URL" required></div> <div class="form-control"><label class="label font-medium mb-1">Bucket</label> <input type="text" class="input input-bordered w-full" placeholder="Enter bucket name" required></div> <div class="form-control"><label class="label font-medium mb-1">Region</label> <input type="text" class="input input-bordered w-full" placeholder="Enter region" required></div> <div class="form-control"><label class="label font-medium mb-1">Access Key</label> <input type="text" class="input input-bordered w-full" placeholder="Enter access key" required></div> <div class="form-control"><label class="label font-medium mb-1">Secret Key</label> <input type="password" class="input input-bordered w-full" placeholder="Enter secret key" required></div></div>');function _e(x){var s=fe();i(x,s)}var ge=m('<div class="alert"><p>Loading datasets...</p></div>'),xe=m('<div class="alert"><p>No datasets found</p></div>'),ye=m("<option> </option>"),he=m('<div class="form-control"><label class="label font-medium mb-1">Search EOTDL Dataset</label> <input type="text" class="input input-bordered w-full mb-2" placeholder="Search datasets..."> <label class="label font-medium mb-1">Select EOTDL Dataset</label> <select class="select select-bordered w-full"></select></div>');function we(x,s){J(s,!0);let n=te(s,"eotdlDatasetId",15,""),d=h(N([])),v=h(!1),p=h(""),k=se(()=>e(d).filter(c=>c.name.toLowerCase().includes(e(p).toLowerCase())));W(async()=>{u(v,!0);const c=await fetch("https://api.eotdl.com/datasets");if(!c.ok)return alert("Failed to fetch EOTDL datasets");u(d,N(await c.json())),u(v,!1)});var b=G(),L=H(b);M(L,()=>e(v),c=>{var C=ge();i(c,C)},c=>{var C=G(),I=H(C);M(I,()=>e(d).length==0,E=>{var S=xe();i(E,S)},E=>{var S=he(),f=a(o(S),2);R(f);var q=a(f,4);Z(q,21,()=>e(k),ee,(T,w)=>{var _=ye(),D={},F=o(_);l(_),$(()=>{D!==(D=e(w).id)&&(_.value=(_.__value=e(w).id)==null?"":e(w).id),Y(F,e(w).name)}),i(T,_)}),l(q),l(S),z(f,()=>e(p),T=>u(p,T)),pe(q,n),i(E,S)},!0),i(c,C)}),i(x,b),Q()}const De=async(x,s,n,d)=>{x.preventDefault(),!(e(s)==""||n().map(v=>v.name).includes(e(s)))&&n().push({name:e(s),color:e(d)})};var ke=(x,s,n)=>s(s().filter(d=>d.name!==e(n).name)),Le=m('<li class="flex items-center gap-2"><button class="btn btn-ghost btn-xs"><!></button> <div class="w-4 h-4 rounded"></div> </li>'),Ce=m('<ul class="mt-2"></ul>'),Ee=m(`<div class="form-control"><label class="label font-medium">Create labels (optional)</label> <p class="text-xs text-gray-600 italic mb-2">You can create labels later in the labelling interface. However, you will
    need to create labels in order to use a Model for assisted labelling (which
    can as well be defined later).</p> <div class="flex"><input type="text" placeholder="new label" class="rounded-r-none input input-sm border border-1 border-gray-300"> <button type="submit" class="rounded-none btn btn-primary btn-sm"><!></button> <div class="box-border flex w-24 rounded-tr-lg rounded-br-lg"><input class="box-border h-full p-0 m-0 rounded-tr-lg rounded-br-lg" type="color"></div></div> <!></div>`);function Se(x,s){J(s,!0);let n=te(s,"labels",31,()=>N([])),d=h("#000000"),v=h(""),p=!1;var k=Ee(),b=a(o(k),4),L=o(b);R(L);var c=a(L,2);c.__click=[De,v,n,d];var C=o(c);ue(C,{size:"15"}),l(c);var I=a(c,2),E=o(I);R(E),l(I),l(b);var S=a(b,2);M(S,()=>n().length>0,f=>{var q=Ce();Z(q,21,n,ee,(T,w)=>{var _=Le(),D=o(_);D.__click=[ke,n,w];var F=o(D);me(F,{size:"15"}),l(D);var K=a(D,2),A=a(K);l(_),$(()=>{ve(K,"background-color",e(w).color),Y(A,` ${e(w).name??""}`)}),i(T,_)}),l(q),i(f,q)}),l(k),$(()=>c.disabled=p),z(L,()=>e(v),f=>u(v,f)),z(E,()=>e(d),f=>u(d,f)),i(x,k),Q()}X(["click"]);const qe=()=>{g.cancel()};var Oe=(x,s)=>u(s,0),Te=()=>{console.log("Coming soon")},$e=(x,s)=>u(s,2),Me=m('<button type="button">EOTDL</button>'),Ie=m('<div class="form-control"><label class="mb-1 font-medium label">Local Folder Path</label> <input type="text" class="w-full input input-bordered" placeholder="Enter folder path" required></div>'),Pe=m('<div class="flex flex-row justify-between alert"><p>Campaign created successfully !</p> <a class="btn btn-primary">Label</a></div>'),Ne=m('<div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="text-sm"> </span> <button type="button" class="btn btn-sm btn-error">Cancel</button></div> <progress class="w-full progress progress-primary" max="100"></progress></div>'),je=m('<div><button class="btn btn-primary md:w-auto md:self-end" type="submit"> </button></div>'),Re=m('<div class="w-full max-w-2xl p-6 mx-auto"><h1 class="mb-6 text-3xl font-bold">Create a new labelling campaign</h1> <form class="flex flex-col gap-4"><div class="form-control"><label for="campaign-name" class="mb-1 font-medium label">Campaign Name</label> <input id="campaign-name" required type="text" class="w-full input input-bordered" placeholder="Enter campaign name"></div> <div class="form-control"><label for="campaign-description" class="mb-1 font-medium label">Campaign Description</label> <input id="campaign-description" required type="text" class="w-full input input-bordered" placeholder="Enter campaign description"></div> <div class="form-control"><label class="mb-2 font-medium label">Select Storage</label> <div class="flex flex-wrap gap-2"><button type="button">Local</button> <button type="button" data-tip="Coming soon">Cloud (S3)</button> <!></div></div> <!> <!> <!> <!></form></div>');function et(x,s){J(s,!0);let n=h(""),d=h(""),v=h(""),p=h(0),k=h(""),b=h(N([])),L=h(N({}));const c=async r=>{if(r.preventDefault(),e(p)==2){if(!e(k))return alert("EOTDL dataset is required");try{g.createEOTDL(e(n),e(d),e(k),e(b),e(L))}catch(t){alert(t)}}else{if(e(p)==1)return alert("S3 not implemented yet");if(e(n)!==""&&e(d)!=="")try{g.create(e(n),e(d),e(v),e(b),e(L))}catch(t){alert(t)}}};W(()=>{g.reset()});var C=Re(),I=a(o(C),2),E=o(I),S=a(o(E),2);R(S),l(E);var f=a(E,2),q=a(o(f),2);R(q),l(f);var T=a(f,2),w=a(o(T),2),_=o(w);_.__click=[Oe,p];var D=a(_,2);D.__click=[Te];var F=a(D,2);M(F,()=>{var r;return(r=ce.data.find(t=>t.name=="eotdl"))==null?void 0:r.enabled},r=>{var t=Me();t.__click=[$e,p],$(()=>B(t,`btn btn-outline ${(e(p)===2?"btn-primary":"")??""}`)),i(r,t)}),l(w),l(T);var K=a(T,2);M(K,()=>e(p)==0,r=>{var t=Ie(),P=a(o(t),2);R(P),l(t),z(P,()=>e(v),y=>u(v,y)),i(r,t)},r=>{var t=G(),P=H(t);M(P,()=>e(p)==1,y=>{_e(y)},y=>{we(y,{get eotdlDatasetId(){return e(k)},set eotdlDatasetId(O){u(k,N(O))}})},!0),i(r,t)});var A=a(K,2);Se(A,{get labels(){return e(b)},set labels(r){u(b,N(r))}});var V=a(A,2);M(V,()=>e(b).length>0,r=>{be(r,{get labels(){return e(b)},get labelMappings(){return e(L)},set labelMappings(t){u(L,N(t))}})});var ae=a(V,2);M(ae,()=>g.completed,r=>{var t=Pe(),P=a(o(t),2);l(t),$(()=>{var y;return ne(P,"href",`/campaigns/label?id=${(y=g.data[0])==null?void 0:y.id}`)}),i(r,t)},r=>{var t=G(),P=H(t);M(P,()=>g.creating,y=>{var O=Ne(),j=o(O),U=o(j),le=o(U);l(U);var re=a(U,2);re.__click=[qe],l(j);var oe=a(j,2);$(()=>ie(oe,isNaN(g.progress)?0:g.progress*100)),l(O),$(()=>Y(le,g.message)),i(y,O)},y=>{var O=je(),j=o(O),U=o(j);l(j),l(O),$(()=>{B(O,`flex w-full gap-4 mt-4 md:w-auto md:self-end ${(g.creating?"hidden":"")??""}`),j.disabled=g.creating,Y(U,g.creating?"Creating...":"Create Campaign")}),i(y,O)},!0),i(r,t)}),l(I),l(C),$(()=>{B(_,`btn btn-outline ${(e(p)===0?"btn-primary":"")??""}`),B(D,`btn btn-outline tooltip ${(e(p)===1?"btn-primary":"")??""}`)}),de("submit",I,c),z(S,()=>e(n),r=>u(n,r)),z(q,()=>e(d),r=>u(d,r)),i(x,C),Q()}X(["click"]);export{et as component};
