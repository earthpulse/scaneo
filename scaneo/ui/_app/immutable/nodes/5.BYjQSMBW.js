import{a as d,t as v,c as Y}from"../chunks/disclose-version.DHz0PKsI.js";import{p as V,N as w,u as ee,f as J,g as e,o as b,a as W,s as a,c as s,r as l,d as ie,t as T}from"../chunks/runtime.B6coxiGD.js";import{s as A}from"../chunks/render.PYmPAuDm.js";import{i as $}from"../chunks/if.PCbA7Ql5.js";import{r as z,b as ne,s as de}from"../chunks/attributes.aUdXhcos.js";import{s as H}from"../chunks/class.5UNJRUNG.js";import{d as te,e as ce}from"../chunks/events.aoiNrylR.js";import{b as F}from"../chunks/input.DJnXoNif.js";import{p as j}from"../chunks/proxy.BT_Zq6Rg.js";import{c as p}from"../chunks/campaigns.svelte.2R2DxKnQ.js";import{p as pe}from"../chunks/plugins.svelte.T5jHxoHF.js";import{e as ae,i as re}from"../chunks/each.Czia2JB_.js";import{b as ue,P as me,D as be}from"../chunks/DeleteOutline.D--ZWbtp.js";import{p as le}from"../chunks/props.Bsy5QBFU.js";import{s as ve,M as fe}from"../chunks/ModelSelector.CkTdikqi.js";var _e=v('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="form-control"><label class="label font-medium mb-1">S3 URL</label> <input type="text" class="input input-bordered w-full" placeholder="Enter S3 URL" required></div> <div class="form-control"><label class="label font-medium mb-1">Bucket</label> <input type="text" class="input input-bordered w-full" placeholder="Enter bucket name" required></div> <div class="form-control"><label class="label font-medium mb-1">Region</label> <input type="text" class="input input-bordered w-full" placeholder="Enter region" required></div> <div class="form-control"><label class="label font-medium mb-1">Access Key</label> <input type="text" class="input input-bordered w-full" placeholder="Enter access key" required></div> <div class="form-control"><label class="label font-medium mb-1">Secret Key</label> <input type="password" class="input input-bordered w-full" placeholder="Enter secret key" required></div></div>');function ge(f){var o=_e();d(f,o)}var ye=v('<div class="alert"><p>Loading datasets...</p></div>'),xe=v('<div class="alert"><p>No datasets found</p></div>'),he=v("<option> </option>"),we=v('<div class="form-control"><label class="label font-medium mb-1">Search EOTDL Dataset</label> <input type="text" class="input input-bordered w-full mb-2" placeholder="Search datasets..."> <label class="label font-medium mb-1">Select EOTDL Dataset</label> <select class="select select-bordered w-full"></select></div>');function ke(f,o){V(o,!0);let i=le(o,"eotdlDatasetId",15,""),n=w(j([])),m=w(!1),u=w(""),L=ie(()=>e(n).filter(c=>c.name.toLowerCase().includes(e(u).toLowerCase())));ee(async()=>{b(m,!0);const c=await fetch("https://api.eotdl.com/datasets");if(!c.ok)return alert("Failed to fetch EOTDL datasets");b(n,j(await c.json())),b(m,!1)});var _=Y(),E=J(_);$(E,()=>e(m),c=>{var I=ye();d(c,I)},c=>{var I=Y(),M=J(I);$(M,()=>e(n).length==0,S=>{var k=xe();d(S,k)},S=>{var k=we(),g=a(s(k),2);z(g);var D=a(g,4);ae(D,21,()=>e(L),re,(N,y)=>{var x=he(),C={},R=s(x);l(x),T(()=>{C!==(C=e(y).id)&&(x.value=(x.__value=e(y).id)==null?"":e(y).id),A(R,e(y).name)}),d(N,x)}),l(D),l(k),F(g,()=>e(u),N=>b(u,N)),ue(D,i),d(S,k)},!0),d(c,I)}),d(f,_),W()}const De=async(f,o,i,n)=>{f.preventDefault(),!(e(o)==""||i().map(m=>m.name).includes(e(o)))&&i().push({name:e(o),color:e(n)})};var Ce=(f,o,i)=>o(o().filter(n=>n.name!==e(i).name)),Le=v('<li class="flex items-center gap-2"><button class="btn btn-ghost btn-xs"><!></button> <div class="w-4 h-4 rounded"></div> </li>'),Ee=v('<ul class="mt-2"></ul>'),Se=v(`<div class="form-control"><label class="label font-medium">Create labels (optional)</label> <p class="text-xs text-gray-600 italic mb-2">You can create labels later in the labelling interface. However, you will
    need to create labels in order to use a Model for assisted labelling (which
    can as well be defined later).</p> <div class="flex"><input type="text" placeholder="new label" class="rounded-r-none input input-sm border border-1 border-gray-300"> <button type="submit" class="rounded-none btn btn-primary btn-sm"><!></button> <div class="box-border flex w-24 rounded-tr-lg rounded-br-lg"><input class="box-border h-full p-0 m-0 rounded-tr-lg rounded-br-lg" type="color"></div></div> <!></div>`);function qe(f,o){V(o,!0);let i=le(o,"labels",31,()=>j([])),n=w("#000000"),m=w(""),u=!1;var L=Se(),_=a(s(L),4),E=s(_);z(E);var c=a(E,2);c.__click=[De,m,i,n];var I=s(c);me(I,{size:"15"}),l(c);var M=a(c,2),S=s(M);z(S),l(M),l(_);var k=a(_,2);$(k,()=>i().length>0,g=>{var D=Ee();ae(D,21,i,re,(N,y)=>{var x=Le(),C=s(x);C.__click=[Ce,i,y];var R=s(C);be(R,{size:"15"}),l(C);var B=a(C,2),G=a(B);l(x),T(()=>{ve(B,"background-color",e(y).color),A(G,` ${e(y).name??""}`)}),d(N,x)}),l(D),d(g,D)}),l(L),T(()=>c.disabled=u),F(E,()=>e(m),g=>b(m,g)),F(S,()=>e(n),g=>b(n,g)),d(f,L),W()}te(["click"]);const Oe=()=>{p.cancel(),creating=!1};var Te=(f,o)=>b(o,0),$e=()=>{console.log("Coming soon")},Ie=(f,o)=>b(o,2),Me=v('<button type="button">EOTDL</button>'),Ne=v('<div class="form-control"><label class="mb-1 font-medium label">Local Folder Path</label> <input type="text" class="w-full input input-bordered" placeholder="Enter folder path" required></div>'),Pe=v('<div class="flex flex-row justify-between alert"><p>Campaign created successfully !</p> <a class="btn btn-primary">Label</a></div>'),je=v('<div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="text-sm"> </span> <button type="button" class="btn btn-sm btn-error">Cancel</button></div> <progress class="w-full progress progress-primary" max="100"></progress></div>'),Re=(f,o)=>o(),ze=v('<div><button class="btn btn-primary md:w-auto md:self-end" type="button"> </button> <button class="btn btn-primary md:w-auto md:self-end" type="submit"> </button></div>'),Fe=v('<div class="w-full max-w-2xl p-6 mx-auto"><h1 class="mb-6 text-3xl font-bold">Create a new labelling campaign</h1> <form class="flex flex-col gap-4"><div class="form-control"><label for="campaign-name" class="mb-1 font-medium label">Campaign Name</label> <input id="campaign-name" required type="text" class="w-full input input-bordered" placeholder="Enter campaign name"></div> <div class="form-control"><label for="campaign-description" class="mb-1 font-medium label">Campaign Description</label> <input id="campaign-description" required type="text" class="w-full input input-bordered" placeholder="Enter campaign description"></div> <div class="form-control"><label class="mb-2 font-medium label">Select Storage</label> <div class="flex flex-wrap gap-2"><button type="button">Local</button> <button type="button" data-tip="Coming soon">Cloud (S3)</button> <!></div></div> <!> <!> <!> <!></form></div>');function at(f,o){V(o,!0);let i=w(""),n=w(""),m=w(""),u=w(0),L=w(""),_=w(j([])),E=w(j({}));const c=async r=>{if(r.preventDefault(),e(u)==2){if(!e(L))return alert("EOTDL dataset is required");try{p.createEOTDL(e(i),e(n),e(L),e(_),e(E))}catch(t){alert(t)}}else{if(e(u)==1)return alert("S3 not implemented yet");if(e(i)!==""&&e(n)!=="")try{p.create(e(i),e(n),e(m),e(_),e(E))}catch(t){alert(t)}}},I=async()=>{if(e(i)!==""&&e(n)!=="")try{p.import(e(i),e(n),e(m))}catch(r){alert(r)}};ee(()=>{p.reset()});var M=Fe(),S=a(s(M),2),k=s(S),g=a(s(k),2);z(g),l(k);var D=a(k,2),N=a(s(D),2);z(N),l(D);var y=a(D,2),x=a(s(y),2),C=s(x);C.__click=[Te,u];var R=a(C,2);R.__click=[$e];var B=a(R,2);$(B,()=>{var r;return(r=pe.data.find(t=>t.name=="eotdl"))==null?void 0:r.enabled},r=>{var t=Me();t.__click=[Ie,u],T(()=>H(t,`btn btn-outline ${(e(u)===2?"btn-primary":"")??""}`)),d(r,t)}),l(x),l(y);var G=a(y,2);$(G,()=>e(u)==0,r=>{var t=Ne(),P=a(s(t),2);z(P),l(t),F(P,()=>e(m),h=>b(m,h)),d(r,t)},r=>{var t=Y(),P=J(t);$(P,()=>e(u)==1,h=>{ge(h)},h=>{ke(h,{get eotdlDatasetId(){return e(L)},set eotdlDatasetId(q){b(L,j(q))}})},!0),d(r,t)});var X=a(G,2);qe(X,{get labels(){return e(_)},set labels(r){b(_,j(r))}});var Z=a(X,2);$(Z,()=>e(_).length>0,r=>{fe(r,{get labels(){return e(_)},get labelMappings(){return e(E)},set labelMappings(t){b(E,j(t))}})});var oe=a(Z,2);$(oe,()=>p.completed,r=>{var t=Pe(),P=a(s(t),2);l(t),T(()=>{var h;return de(P,"href",`/campaigns/label?id=${(h=p.data[0])==null?void 0:h.id}`)}),d(r,t)},r=>{var t=Y(),P=J(t);$(P,()=>p.creating,h=>{var q=je(),O=s(q),K=s(O),U=s(K);l(K);var Q=a(K,2);Q.__click=[Oe],l(O);var se=a(O,2);T(()=>ne(se,isNaN(p.progress)?0:p.progress*100)),l(q),T(()=>A(U,p.message)),d(h,q)},h=>{var q=ze(),O=s(q);O.__click=[Re,I];var K=s(O);l(O);var U=a(O,2),Q=s(U);l(U),l(q),T(()=>{H(q,`flex w-full gap-4 mt-4 md:w-auto md:self-end ${(p.creating?"hidden":"")??""}`),O.disabled=p.creating,A(K,p.creating?"Creating...":"Import Campaign"),U.disabled=p.creating,A(Q,p.creating?"Creating...":"Create Campaign")}),d(h,q)},!0),d(r,t)}),l(S),l(M),T(()=>{H(C,`btn btn-outline ${(e(u)===0?"btn-primary":"")??""}`),H(R,`btn btn-outline tooltip ${(e(u)===1?"btn-primary":"")??""}`)}),ce("submit",S,c),F(g,()=>e(i),r=>b(i,r)),F(N,()=>e(n),r=>b(n,r)),d(f,M),W()}te(["click"]);export{at as component};
