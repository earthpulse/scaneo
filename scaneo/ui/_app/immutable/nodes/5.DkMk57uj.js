import{a as n,t as b,c as H,d as W,e as se}from"../chunks/disclose-version.BmQdNnQs.js";import{p as J,e as h,u as X,f as Y,g as e,b as m,a as Q,s as a,c as o,r,d as ne,t as $}from"../chunks/runtime.DxIuT8bo.js";import{s as I}from"../chunks/render.DvgmjyIU.js";import{i as T}from"../chunks/if.CylRvQJX.js";import{r as U,a as ie,s as de}from"../chunks/attributes.DoQyPotG.js";import{s as G}from"../chunks/class.CFsCnGgX.js";import{b as z}from"../chunks/input.Bjo9v0tX.js";import{p as j}from"../chunks/proxy.DqozBE76.js";import{c as u}from"../chunks/campaigns.svelte.BewoAAv2.js";import{p as ce}from"../chunks/plugins.svelte.Cem7Gifa.js";import{e as Z,i as ee}from"../chunks/each.4pS6kvS6.js";import{b as pe,P as ue,D as me}from"../chunks/DeleteOutline.B6H577wE.js";import{p as te}from"../chunks/props.DAkrzDwa.js";import{s as be,M as ve}from"../chunks/ModelSelector.CYtwkAlB.js";import{b as fe}from"../chunks/fetcher.DqgCpJxC.js";import{o as _e}from"../chunks/index-client.X3yzDWTZ.js";var ge=b('<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="form-control"><label class="label font-medium mb-1">S3 URL</label> <input type="text" class="input input-bordered w-full" placeholder="Enter S3 URL" required></div> <div class="form-control"><label class="label font-medium mb-1">Bucket</label> <input type="text" class="input input-bordered w-full" placeholder="Enter bucket name" required></div> <div class="form-control"><label class="label font-medium mb-1">Region</label> <input type="text" class="input input-bordered w-full" placeholder="Enter region" required></div> <div class="form-control"><label class="label font-medium mb-1">Access Key</label> <input type="text" class="input input-bordered w-full" placeholder="Enter access key" required></div> <div class="form-control"><label class="label font-medium mb-1">Secret Key</label> <input type="password" class="input input-bordered w-full" placeholder="Enter secret key" required></div></div>');function xe(x){var s=ge();n(x,s)}var ye=b('<div class="alert"><p>Loading datasets...</p></div>'),he=b('<div class="alert"><p>No datasets found</p></div>'),we=b("<option> </option>"),De=b('<div class="form-control"><label class="label font-medium mb-1">Search EOTDL Dataset</label> <input type="text" class="input input-bordered w-full mb-2" placeholder="Search datasets..."> <label class="label font-medium mb-1">Select EOTDL Dataset</label> <select class="select select-bordered w-full"></select></div>');function ke(x,s){J(s,!0);let i=te(s,"eotdlDatasetName",15,""),d=h(j([])),v=h(!1),p=h(""),k=ne(()=>e(d).filter(c=>c.name.toLowerCase().includes(e(p).toLowerCase())));X(async()=>{m(v,!0);const c=await fetch("https://api.eotdl.com/datasets");if(!c.ok)return alert("Failed to fetch EOTDL datasets");m(d,j(await c.json())),m(v,!1)});var f=H(),L=Y(f);T(L,()=>e(v),c=>{var C=ye();n(c,C)},c=>{var C=H(),M=Y(C);T(M,()=>e(d).length==0,E=>{var S=he();n(E,S)},E=>{var S=De(),_=a(o(S),2);U(_);var q=a(_,4);Z(q,21,()=>e(k),ee,(O,w)=>{var g=we(),D={},F=o(g);r(g),$(()=>{D!==(D=e(w).name)&&(g.value=(g.__value=e(w).name)==null?"":e(w).name),I(F,e(w).name)}),n(O,g)}),r(q),r(S),z(_,()=>e(p),O=>m(p,O)),pe(q,i),n(E,S)},!0),n(c,C)}),n(x,f),Q()}const Le=async(x,s,i,d)=>{x.preventDefault(),!(e(s)==""||i().map(v=>v.name).includes(e(s)))&&i().push({name:e(s),color:e(d)})};var Ce=(x,s,i)=>s(s().filter(d=>d.name!==e(i).name)),Ee=b('<li class="flex items-center gap-2"><button class="btn btn-ghost btn-xs"><!></button> <div class="w-4 h-4 rounded"></div> </li>'),Se=b('<ul class="mt-2"></ul>'),qe=b(`<div class="form-control"><label class="label font-medium">Create labels (optional)</label> <p class="text-xs text-gray-600 italic mb-2">You can create labels later in the labelling interface. However, you will
    need to create labels in order to use a Model for assisted labelling (which
    can as well be defined later).</p> <div class="flex"><input type="text" placeholder="new label" class="rounded-r-none input input-sm border border-1 border-gray-300"> <button type="submit" class="rounded-none btn btn-primary btn-sm"><!></button> <div class="box-border flex w-24 rounded-tr-lg rounded-br-lg"><input class="box-border h-full p-0 m-0 rounded-tr-lg rounded-br-lg" type="color"></div></div> <!></div>`);function Ne(x,s){J(s,!0);let i=te(s,"labels",31,()=>j([])),d=h("#000000"),v=h(""),p=!1;var k=qe(),f=a(o(k),4),L=o(f);U(L);var c=a(L,2);c.__click=[Le,v,i,d];var C=o(c);ue(C,{size:"15"}),r(c);var M=a(c,2),E=o(M);U(E),r(M),r(f);var S=a(f,2);T(S,()=>i().length>0,_=>{var q=Se();Z(q,21,i,ee,(O,w)=>{var g=Ee(),D=o(g);D.__click=[Ce,i,w];var F=o(D);me(F,{size:"15"}),r(D);var K=a(D,2),B=a(K);r(g),$(()=>{be(K,"background-color",e(w).color),I(B,` ${e(w).name??""}`)}),n(O,g)}),r(q),n(_,q)}),r(k),$(()=>c.disabled=p),z(L,()=>e(v),_=>m(v,_)),z(E,()=>e(d),_=>m(d,_)),n(x,k),Q()}W(["click"]);const Oe=()=>{u.cancel()};var $e=(x,s)=>m(s,0),Te=()=>{console.log("Coming soon")},Me=(x,s)=>m(s,2),Pe=b('<button type="button">EOTDL</button>'),je=b('<div class="form-control"><label class="mb-1 font-medium label">Local Folder Path</label> <input type="text" class="w-full input input-bordered" placeholder="Enter folder path" required></div>'),Re=b('<div class="flex flex-row justify-between alert"><p>Campaign created successfully !</p> <a class="btn btn-primary">Label</a></div>'),Ue=b('<div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="text-sm"> </span> <button type="button" class="btn btn-sm btn-error">Cancel</button></div> <progress class="w-full progress progress-primary" max="100"></progress></div>'),ze=b('<div><button class="btn btn-primary md:w-auto md:self-end" type="submit"> </button></div>'),Fe=b('<div class="w-full max-w-2xl p-6 mx-auto"><h1 class="mb-6 text-3xl font-bold">Create a new labelling campaign</h1> <form class="flex flex-col gap-4"><div class="form-control"><label for="campaign-name" class="mb-1 font-medium label">Campaign Name</label> <input id="campaign-name" required type="text" class="w-full input input-bordered" placeholder="Enter campaign name"></div> <div class="form-control"><label for="campaign-description" class="mb-1 font-medium label">Campaign Description</label> <input id="campaign-description" required type="text" class="w-full input input-bordered" placeholder="Enter campaign description"></div> <div class="form-control"><label class="mb-2 font-medium label">Select Storage</label> <div class="flex flex-wrap gap-2"><button type="button">Local</button> <button type="button" data-tip="Coming soon">Cloud (S3)</button> <!></div></div> <!> <!> <!> <!></form></div>');function rt(x,s){J(s,!0);let i=h(""),d=h(""),v=h(""),p=h(0),k=h(""),f=h(j([])),L=h(j({}));const c=async l=>{if(l.preventDefault(),e(p)==2){if(!e(k))return alert("EOTDL dataset is required");try{u.createEOTDL(e(i),e(d),e(k),e(f),e(L))}catch(t){alert(t)}}else{if(e(p)==1)return alert("S3 not implemented yet");if(e(i)!==""&&e(d)!=="")try{u.create(e(i),e(d),e(v),e(f),e(L))}catch(t){alert(t)}}};X(()=>{u.reset()}),_e(()=>{u.reset()});var C=Fe(),M=a(o(C),2),E=o(M),S=a(o(E),2);U(S),r(E);var _=a(E,2),q=a(o(_),2);U(q),r(_);var O=a(_,2),w=a(o(O),2),g=o(w);g.__click=[$e,p];var D=a(g,2);D.__click=[Te];var F=a(D,2);T(F,()=>{var l;return(l=ce.data.find(t=>t.name=="eotdl"))==null?void 0:l.enabled},l=>{var t=Pe();t.__click=[Me,p],$(()=>G(t,`btn btn-outline ${(e(p)===2?"btn-primary":"")??""}`)),n(l,t)}),r(w),r(O);var K=a(O,2);T(K,()=>e(p)==0,l=>{var t=je(),P=a(o(t),2);U(P),r(t),z(P,()=>e(v),y=>m(v,y)),n(l,t)},l=>{var t=H(),P=Y(t);T(P,()=>e(p)==1,y=>{xe(y)},y=>{ke(y,{get eotdlDatasetName(){return e(k)},set eotdlDatasetName(N){m(k,j(N))}})},!0),n(l,t)});var B=a(K,2);Ne(B,{get labels(){return e(f)},set labels(l){m(f,j(l))}});var V=a(B,2);T(V,()=>e(f).length>0,l=>{ve(l,{get labels(){return e(f)},get labelMappings(){return e(L)},set labelMappings(t){m(L,j(t))}})});var ae=a(V,2);T(ae,()=>u.completed,l=>{var t=Re(),P=a(o(t),2);r(t),$(()=>{var y;return de(P,"href",`${fe.url}/campaigns/label?id=${(y=u.data[0])==null?void 0:y.id}`)}),n(l,t)},l=>{var t=H(),P=Y(t);T(P,()=>u.creating,y=>{var N=Ue(),R=o(N),A=o(R),re=o(A);r(A);var le=a(A,2);le.__click=[Oe],r(R);var oe=a(R,2);$(()=>ie(oe,isNaN(u.progress)?0:u.progress*100)),r(N),$(()=>I(re,u.message)),n(y,N)},y=>{var N=ze(),R=o(N),A=o(R);r(R),r(N),$(()=>{G(N,`flex w-full gap-4 mt-4 md:w-auto md:self-end ${(u.creating?"hidden":"")??""}`),R.disabled=u.creating,I(A,u.creating?"Creating...":"Create Campaign")}),n(y,N)},!0),n(l,t)}),r(M),r(C),$(()=>{G(g,`btn btn-outline ${(e(p)===0?"btn-primary":"")??""}`),G(D,`btn btn-outline tooltip ${(e(p)===1?"btn-primary":"")??""}`)}),se("submit",M,c),z(S,()=>e(i),l=>m(i,l)),z(q,()=>e(d),l=>m(d,l)),n(x,C),Q()}W(["click"]);export{rt as component};
