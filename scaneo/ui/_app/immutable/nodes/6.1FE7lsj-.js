import{d as J,e as K,a as o,t as i,c as j}from"../chunks/disclose-version.BmQdNnQs.js";import{p as M,u as Q,t as g,a as R,f as k,s as v,g as l,b as I,e as N,c as n,n as U,r as p,d as V}from"../chunks/runtime.DxIuT8bo.js";import{s as h}from"../chunks/render.DvgmjyIU.js";import{i as x}from"../chunks/if.CylRvQJX.js";import{r as O,a as W}from"../chunks/attributes.DoQyPotG.js";import{b as X,a as Z}from"../chunks/input.Bjo9v0tX.js";import{s as ee,a as te,p as ae}from"../chunks/stores.BM55Gnx8.js";import{c as a}from"../chunks/campaigns.svelte.Rq1oEeHj.js";import{o as re}from"../chunks/index-client.X3yzDWTZ.js";const se=()=>{a.cancel()};var oe=i("<p> </p>"),ne=i('<input type="text" class="input input-bordered w-full mt-2" placeholder="Enter export path" required>'),pe=i('<p>This is an EOTDL dataset. Choose one export option:</p> <div class="form-control"><label class="cursor-pointer gap-2 flex flex-row items-center"><input type="radio" name="export-type" class="radio radio-xs"> <span class="label-text">Export to local folder (only annotations)</span></label> <!></div>',1),le=i("<p>Something went wrong :(</p>"),ie=i('<div class="flex flex-row justify-between alert"><p>Campaign exported successfully !</p></div>'),ce=i('<div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="text-sm"> </span> <button type="button" class="btn btn-sm btn-error">Cancel</button></div> <progress class="w-full progress progress-primary" max="100"></progress></div>'),ve=i('<button class="btn btn-outline" type="submit">Export campaign</button>'),de=i('<div class="w-full max-w-2xl p-6 mx-auto"><form class="flex flex-col gap-4"><!> <p> </p> <p> </p> <!></form></div>');function we(q,A){M(A,!0);const L=ee(),P=()=>te(ae,"$page",L),S=[];let Y=V(()=>a.exporting),u=N("folder"),b=N("");Q(()=>{a.retrieveOne(P().url.searchParams.get("id"))});const z=t=>{if(!(l(u)==="folder"&&!l(b))){t.preventDefault();try{a.export(P().url.searchParams.get("id"),l(u),l(b))}catch(e){alert(e.message)}}};re(()=>{a.reset()});var y=de(),w=n(y),T=n(w);x(T,()=>{var t;return(t=a.current)==null?void 0:t.path},t=>{var e=oe(),f=n(e);p(e),g(()=>{var r;return h(f,`Your annotations will be exported at: ${((r=a.current)==null?void 0:r.path)??""}`)}),o(t,e)},t=>{var e=j(),f=k(e);x(f,()=>{var r;return(r=a.current)==null?void 0:r.eotdlDatasetId},r=>{var s=pe(),d=v(k(s),2),c=n(d),m=n(c);O(m),m.value=(m.__value="folder")==null?"":"folder",U(2),p(c);var D=v(c,2);x(D,()=>l(u)==="folder",_=>{var E=ne();O(E),X(E,()=>l(b),H=>I(b,H)),o(_,E)}),p(d),Z(S,[],m,()=>l(u),_=>I(u,_)),o(r,s)},r=>{var s=le();o(r,s)},!0),o(t,e)});var $=v(T,2),B=n($);p($);var C=v($,2),F=n(C);p(C);var G=v(C,2);x(G,()=>a.completed,t=>{var e=ie();o(t,e)},t=>{var e=j(),f=k(e);x(f,()=>a.exporting,r=>{var s=ce(),d=n(s),c=n(d),m=n(c);p(c);var D=v(c,2);D.__click=[se],p(d);var _=v(d,2);g(()=>W(_,isNaN(a.progress)?0:a.progress*100)),p(s),g(()=>h(m,a.message)),o(r,s)},r=>{var s=ve();g(()=>s.disabled=l(Y)),o(r,s)},!0),o(t,e)}),p(w),p(y),g(()=>{var t,e;h(B,`Images: ${((t=a.current)==null?void 0:t.image_count)??""}`),h(F,`Annotations: ${((e=a.current)==null?void 0:e.annotation_count)??""}`)}),K("submit",w,z),o(q,y),R()}J(["click"]);export{we as component};
