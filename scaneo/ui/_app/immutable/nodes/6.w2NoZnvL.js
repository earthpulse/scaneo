import{d as U,e as V,a as l,t as c,c as q}from"../chunks/disclose-version.BmQdNnQs.js";import{p as W,u as X,t as g,a as Z,f as O,s as i,g as p,b as P,e as A,c as s,n as S,r as o,d as ee}from"../chunks/runtime.DxIuT8bo.js";import{s as $}from"../chunks/render.DvgmjyIU.js";import{i as b}from"../chunks/if.CylRvQJX.js";import{r as j,a as te}from"../chunks/attributes.DoQyPotG.js";import{b as ae,a as Y}from"../chunks/input.Bjo9v0tX.js";import{s as re,a as se,p as oe}from"../chunks/stores.Brgn634O.js";import{c as a}from"../chunks/campaigns.svelte.BewoAAv2.js";import{o as ne}from"../chunks/index-client.X3yzDWTZ.js";const le=()=>{a.cancel()};var pe=c("<p> </p>"),ie=c('<input type="text" class="input input-bordered w-full mt-2" placeholder="Enter export path" required>'),ce=c('<p>This is an EOTDL dataset. Choose one export option:</p> <div class="form-control"><label class="cursor-pointer gap-2 flex flex-row items-center"><input type="radio" name="export-type" class="radio radio-xs"> <span class="label-text">Export to EOTDL</span></label></div> <div class="form-control"><label class="cursor-pointer gap-2 flex flex-row items-center"><input type="radio" name="export-type" class="radio radio-xs"> <span class="label-text">Export to local folder (only annotations)</span></label> <!></div>',1),ve=c("<p>Something went wrong :(</p>"),de=c('<div class="flex flex-row justify-between alert"><p>Campaign exported successfully !</p></div>'),ue=c('<div class="flex flex-col gap-2"><div class="flex items-center justify-between"><span class="text-sm"> </span> <button type="button" class="btn btn-sm btn-error">Cancel</button></div> <progress class="w-full progress progress-primary" max="100"></progress></div>'),me=c('<button class="btn btn-outline" type="submit">Export campaign</button>'),fe=c('<div class="w-full max-w-2xl p-6 mx-auto"><form class="flex flex-col gap-4"><!> <p> </p> <p> </p> <!></form></div>');function De(z,B){W(B,!0);const F=re(),I=()=>se(oe,"$page",F),L=[];let G=ee(()=>a.exporting),v=A(""),y=A("");X(()=>{a.retrieveOne(I().url.searchParams.get("id"))});const H=t=>{if(!(p(v)==="folder"&&!p(y))){t.preventDefault();try{a.export(I().url.searchParams.get("id"),p(v),p(y))}catch(e){alert(e.message)}}};ne(()=>{a.reset()});var E=fe(),D=s(E),N=s(D);b(N,()=>{var t;return(t=a.current)==null?void 0:t.path},t=>{var e=pe(),f=s(e);o(e),g(()=>{var r;return $(f,`Your annotations will be exported at: ${((r=a.current)==null?void 0:r.path)??""}`)}),l(t,e)},t=>{var e=q(),f=O(e);b(f,()=>{var r;return(r=a.current)==null?void 0:r.eotdlDatasetId},r=>{var n=ce(),d=i(O(n),2),u=s(d),m=s(u);j(m),m.value=(m.__value="eotdl")==null?"":"eotdl",S(2),o(u),o(d);var h=i(d,2),_=s(h),w=s(_);j(w),w.value=(w.__value="folder")==null?"":"folder",S(2),o(_);var Q=i(_,2);b(Q,()=>p(v)==="folder",x=>{var k=ie();j(k),ae(k,()=>p(y),R=>P(y,R)),l(x,k)}),o(h),Y(L,[],m,()=>p(v),x=>P(v,x)),Y(L,[],w,()=>p(v),x=>P(v,x)),l(r,n)},r=>{var n=ve();l(r,n)},!0),l(t,e)});var C=i(N,2),J=s(C);o(C);var T=i(C,2),K=s(T);o(T);var M=i(T,2);b(M,()=>a.completed,t=>{var e=de();l(t,e)},t=>{var e=q(),f=O(e);b(f,()=>a.exporting,r=>{var n=ue(),d=s(n),u=s(d),m=s(u);o(u);var h=i(u,2);h.__click=[le],o(d);var _=i(d,2);g(()=>te(_,isNaN(a.progress)?0:a.progress*100)),o(n),g(()=>$(m,a.message)),l(r,n)},r=>{var n=me();g(()=>n.disabled=p(G)),l(r,n)},!0),l(t,e)}),o(D),o(E),g(()=>{var t,e;$(J,`Images: ${((t=a.current)==null?void 0:t.image_count)??""}`),$(K,`Annotations: ${((e=a.current)==null?void 0:e.annotation_count)??""}`)}),V("submit",D,H),l(z,E),Z()}U(["click"]);export{De as component};
