var P=63710088e-1,It={centimeters:P*100,centimetres:P*100,degrees:P/111325,feet:P*3.28084,inches:P*39.37,kilometers:P/1e3,kilometres:P/1e3,meters:P,metres:P,miles:P/1609.344,millimeters:P*1e3,millimetres:P*1e3,nauticalmiles:P/1852,radians:1,yards:P*1.0936};function st(i,t,e){e===void 0&&(e={});var n={type:"Feature"};return(e.id===0||e.id)&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.properties=t||{},n.geometry=i,n}function kt(i,t,e){if(e===void 0&&(e={}),!i)throw new Error("coordinates is required");if(!Array.isArray(i))throw new Error("coordinates must be an Array");if(i.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ht(i[0])||!ht(i[1]))throw new Error("coordinates must contain numbers");var n={type:"Point",coordinates:i};return st(n,t,e)}function ot(i,t,e){e===void 0&&(e={});for(var n=0,s=i;n<s.length;n++){var r=s[n];if(r.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var u=0;u<r[r.length-1].length;u++)if(r[r.length-1][u]!==r[0][u])throw new Error("First and last Position are not equivalent.")}var o={type:"Polygon",coordinates:i};return st(o,t,e)}function bt(i,t,e){e===void 0&&(e={});var n={type:"MultiPolygon",coordinates:i};return st(n,t,e)}function At(i,t){t===void 0&&(t="kilometers");var e=It[t];if(!e)throw new Error(t+" units is invalid");return i/e}function ut(i){var t=i%(2*Math.PI);return t*180/Math.PI}function Z(i){var t=i%360;return t*Math.PI/180}function ht(i){return!isNaN(i)&&i!==null&&!Array.isArray(i)}function Dt(i){if(!i)throw new Error("coord is required");if(!Array.isArray(i)){if(i.type==="Feature"&&i.geometry!==null&&i.geometry.type==="Point")return i.geometry.coordinates;if(i.type==="Point")return i.coordinates}if(Array.isArray(i)&&i.length>=2&&!Array.isArray(i[0])&&!Array.isArray(i[1]))return i;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function X(i){return i.type==="Feature"?i.geometry:i}function Ot(i,t,e,n){n===void 0&&(n={});var s=Dt(i),r=Z(s[0]),u=Z(s[1]),o=Z(e),a=At(t,n.units),h=Math.asin(Math.sin(u)*Math.cos(a)+Math.cos(u)*Math.sin(a)*Math.cos(o)),p=r+Math.atan2(Math.sin(o)*Math.sin(a)*Math.cos(u),Math.cos(a)-Math.sin(u)*Math.sin(h)),l=ut(p),c=ut(h);return kt([l,c],n.properties)}function Ct(i,t,e){e===void 0&&(e={});for(var n=e.steps||64,s=e.properties?e.properties:!Array.isArray(i)&&i.type==="Feature"&&i.properties?i.properties:{},r=[],u=0;u<n;u++)r.push(Ot(i,t,u*-360/n,e).geometry.coordinates);return r.push(r[0]),ot([r],s)}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Nt(i,t){var e={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},n,s,r,u;return u={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function o(h){return function(p){return a([h,p])}}function a(h){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,s&&(r=h[0]&2?s.return:h[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,h[1])).done)return r;switch(s=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return e.label++,{value:h[1],done:!1};case 5:e.label++,s=h[1],h=[0];continue;case 7:h=e.ops.pop(),e.trys.pop();continue;default:if(r=e.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){e=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){e.label=h[1];break}if(h[0]===6&&e.label<r[1]){e.label=r[1],r=h;break}if(r&&e.label<r[2]){e.label=r[2],e.ops.push(h);break}r[2]&&e.ops.pop(),e.trys.pop();continue}h=t.call(i,e)}catch(p){h=[6,p],s=0}finally{n=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}}var $=function(){function i(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null}return i}();function Ut(i,t){return i>t?1:i<t?-1:0}function z(i,t,e){for(var n=new $(null,null),s=n,r=n;;){var u=e(i,t.key);if(u<0){if(t.left===null)break;if(e(i,t.left.key)<0){var o=t.left;if(t.left=o.right,o.right=t,t=o,t.left===null)break}r.left=t,r=t,t=t.left}else if(u>0){if(t.right===null)break;if(e(i,t.right.key)>0){var o=t.right;if(t.right=o.left,o.left=t,t=o,t.right===null)break}s.right=t,s=t,t=t.right}else break}return s.right=t.left,r.left=t.right,t.left=n.right,t.right=n.left,t}function W(i,t,e,n){var s=new $(i,t);if(e===null)return s.left=s.right=null,s;e=z(i,e,n);var r=n(i,e.key);return r<0?(s.left=e.left,s.right=e,e.left=null):r>=0&&(s.right=e.right,s.left=e,e.right=null),s}function at(i,t,e){var n=null,s=null;if(t){t=z(i,t,e);var r=e(t.key,i);r===0?(n=t.left,s=t.right):r<0?(s=t.right,t.right=null,n=t):(n=t.left,t.left=null,s=t)}return{left:n,right:s}}function zt(i,t,e){return t===null?i:(i===null||(t=z(i.key,t,e),t.left=i),t)}function tt(i,t,e,n,s){if(i){n(""+t+(e?"└── ":"├── ")+s(i)+`
`);var r=t+(e?"    ":"│   ");i.left&&tt(i.left,r,!1,n,s),i.right&&tt(i.right,r,!0,n,s)}}var lt=function(){function i(t){t===void 0&&(t=Ut),this._root=null,this._size=0,this._comparator=t}return i.prototype.insert=function(t,e){return this._size++,this._root=W(t,e,this._root,this._comparator)},i.prototype.add=function(t,e){var n=new $(t,e);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var s=this._comparator,r=z(t,this._root,s),u=s(t,r.key);return u===0?this._root=r:(u<0?(n.left=r.left,n.right=r,r.left=null):u>0&&(n.right=r.right,n.left=r,r.right=null),this._size++,this._root=n),this._root},i.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},i.prototype._remove=function(t,e,n){var s;if(e===null)return null;e=z(t,e,n);var r=n(t,e.key);return r===0?(e.left===null?s=e.right:(s=z(t,e.left,n),s.right=e.right),this._size--,s):e},i.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=z(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},i.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var s=n(t,e.key);if(s===0)return e;s<0?e=e.left:e=e.right}return null},i.prototype.find=function(t){return this._root&&(this._root=z(t,this._root,this._comparator),this._comparator(t,this._root.key)!==0)?null:this._root},i.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var s=n(t,e.key);if(s===0)return!0;s<0?e=e.left:e=e.right}return!1},i.prototype.forEach=function(t,e){for(var n=this._root,s=[],r=!1;!r;)n!==null?(s.push(n),n=n.left):s.length!==0?(n=s.pop(),t.call(e,n),n=n.right):r=!0;return this},i.prototype.range=function(t,e,n,s){for(var r=[],u=this._comparator,o=this._root,a;r.length!==0||o;)if(o)r.push(o),o=o.left;else{if(o=r.pop(),a=u(o.key,e),a>0)break;if(u(o.key,t)>=0&&n.call(s,o))return this;o=o.right}return this},i.prototype.keys=function(){var t=[];return this.forEach(function(e){var n=e.key;return t.push(n)}),t},i.prototype.values=function(){var t=[];return this.forEach(function(e){var n=e.data;return t.push(n)}),t},i.prototype.min=function(){return this._root?this.minNode(this._root).key:null},i.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},i.prototype.minNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.left;)t=t.left;return t},i.prototype.maxNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.right;)t=t.right;return t},i.prototype.at=function(t){for(var e=this._root,n=!1,s=0,r=[];!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),s===t)return e;s++,e=e.right}else n=!0;return null},i.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var s=this._comparator;e;){var r=s(t.key,e.key);if(r===0)break;r<0?(n=e,e=e.left):e=e.right}return n},i.prototype.prev=function(t){var e=this._root,n=null;if(t.left!==null){for(n=t.left;n.right;)n=n.right;return n}for(var s=this._comparator;e;){var r=s(t.key,e.key);if(r===0)break;r<0?e=e.left:(n=e,e=e.right)}return n},i.prototype.clear=function(){return this._root=null,this._size=0,this},i.prototype.toList=function(){return Tt(this._root)},i.prototype.load=function(t,e,n){e===void 0&&(e=[]),n===void 0&&(n=!1);var s=t.length,r=this._comparator;if(n&&it(t,e,0,s-1,r),this._root===null)this._root=et(t,e,0,s),this._size=s;else{var u=$t(this.toList(),Bt(t,e),r);s=this._size+s,this._root=nt({head:u},0,s)}return this},i.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(i.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),i.prototype.toString=function(t){t===void 0&&(t=function(n){return String(n.key)});var e=[];return tt(this._root,"",!0,function(n){return e.push(n)},t),e.join("")},i.prototype.update=function(t,e,n){var s=this._comparator,r=at(t,this._root,s),u=r.left,o=r.right;s(t,e)<0?o=W(e,n,o,s):u=W(e,n,u,s),this._root=zt(u,o,s)},i.prototype.split=function(t){return at(t,this._root,this._comparator)},i.prototype[Symbol.iterator]=function(){var t,e,n;return Nt(this,function(s){switch(s.label){case 0:t=this._root,e=[],n=!1,s.label=1;case 1:return n?[3,6]:t===null?[3,2]:(e.push(t),t=t.left,[3,5]);case 2:return e.length===0?[3,4]:(t=e.pop(),[4,t]);case 3:return s.sent(),t=t.right,[3,5];case 4:n=!0,s.label=5;case 5:return[3,1];case 6:return[2]}})},i}();function et(i,t,e,n){var s=n-e;if(s>0){var r=e+Math.floor(s/2),u=i[r],o=t[r],a=new $(u,o);return a.left=et(i,t,e,r),a.right=et(i,t,r+1,n),a}return null}function Bt(i,t){for(var e=new $(null,null),n=e,s=0;s<i.length;s++)n=n.next=new $(i[s],t[s]);return n.next=null,e.next}function Tt(i){for(var t=i,e=[],n=!1,s=new $(null,null),r=s;!n;)t?(e.push(t),t=t.left):e.length>0?(t=r=r.next=e.pop(),t=t.right):n=!0;return r.next=null,s.next}function nt(i,t,e){var n=e-t;if(n>0){var s=t+Math.floor(n/2),r=nt(i,t,s),u=i.head;return u.left=r,i.head=i.head.next,u.right=nt(i,s+1,e),u}return null}function $t(i,t,e){for(var n=new $(null,null),s=n,r=i,u=t;r!==null&&u!==null;)e(r.key,u.key)<0?(s.next=r,r=r.next):(s.next=u,u=u.next),s=s.next;return r!==null?s.next=r:u!==null&&(s.next=u),n.next}function it(i,t,e,n,s){if(!(e>=n)){for(var r=i[e+n>>1],u=e-1,o=n+1;;){do u++;while(s(i[u],r)<0);do o--;while(s(i[o],r)>0);if(u>=o)break;var a=i[u];i[u]=i[o],i[o]=a,a=t[u],t[u]=t[o],t[o]=a}it(i,t,e,o,s),it(i,t,o+1,n,s)}}const U=11102230246251565e-32,S=134217729,Ft=(3+8*U)*U;function H(i,t,e,n,s){let r,u,o,a,h=t[0],p=n[0],l=0,c=0;p>h==p>-h?(r=h,h=t[++l]):(r=p,p=n[++c]);let f=0;if(l<i&&c<e)for(p>h==p>-h?(u=h+r,o=r-(u-h),h=t[++l]):(u=p+r,o=r-(u-p),p=n[++c]),r=u,o!==0&&(s[f++]=o);l<i&&c<e;)p>h==p>-h?(u=r+h,a=u-r,o=r-(u-a)+(h-a),h=t[++l]):(u=r+p,a=u-r,o=r-(u-a)+(p-a),p=n[++c]),r=u,o!==0&&(s[f++]=o);for(;l<i;)u=r+h,a=u-r,o=r-(u-a)+(h-a),h=t[++l],r=u,o!==0&&(s[f++]=o);for(;c<e;)u=r+p,a=u-r,o=r-(u-a)+(p-a),p=n[++c],r=u,o!==0&&(s[f++]=o);return(r!==0||f===0)&&(s[f++]=r),f}function Gt(i,t){let e=t[0];for(let n=1;n<i;n++)e+=t[n];return e}function Q(i){return new Float64Array(i)}const jt=(3+16*U)*U,qt=(2+12*U)*U,Qt=(9+64*U)*U*U,F=Q(4),ct=Q(8),ft=Q(12),pt=Q(16),M=Q(4);function Yt(i,t,e,n,s,r,u){let o,a,h,p,l,c,f,y,g,m,d,x,_,v,E,w,R,b;const k=i-s,A=e-s,D=t-r,O=n-r;v=k*O,c=S*k,f=c-(c-k),y=k-f,c=S*O,g=c-(c-O),m=O-g,E=y*m-(v-f*g-y*g-f*m),w=D*A,c=S*D,f=c-(c-D),y=D-f,c=S*A,g=c-(c-A),m=A-g,R=y*m-(w-f*g-y*g-f*m),d=E-R,l=E-d,F[0]=E-(d+l)+(l-R),x=v+d,l=x-v,_=v-(x-l)+(d-l),d=_-w,l=_-d,F[1]=_-(d+l)+(l-w),b=x+d,l=b-x,F[2]=x-(b-l)+(d-l),F[3]=b;let N=Gt(4,F),G=qt*u;if(N>=G||-N>=G||(l=i-k,o=i-(k+l)+(l-s),l=e-A,h=e-(A+l)+(l-s),l=t-D,a=t-(D+l)+(l-r),l=n-O,p=n-(O+l)+(l-r),o===0&&a===0&&h===0&&p===0)||(G=Qt*u+Ft*Math.abs(N),N+=k*p+O*o-(D*h+A*a),N>=G||-N>=G))return N;v=o*O,c=S*o,f=c-(c-o),y=o-f,c=S*O,g=c-(c-O),m=O-g,E=y*m-(v-f*g-y*g-f*m),w=a*A,c=S*a,f=c-(c-a),y=a-f,c=S*A,g=c-(c-A),m=A-g,R=y*m-(w-f*g-y*g-f*m),d=E-R,l=E-d,M[0]=E-(d+l)+(l-R),x=v+d,l=x-v,_=v-(x-l)+(d-l),d=_-w,l=_-d,M[1]=_-(d+l)+(l-w),b=x+d,l=b-x,M[2]=x-(b-l)+(d-l),M[3]=b;const Pt=H(4,F,4,M,ct);v=k*p,c=S*k,f=c-(c-k),y=k-f,c=S*p,g=c-(c-p),m=p-g,E=y*m-(v-f*g-y*g-f*m),w=D*h,c=S*D,f=c-(c-D),y=D-f,c=S*h,g=c-(c-h),m=h-g,R=y*m-(w-f*g-y*g-f*m),d=E-R,l=E-d,M[0]=E-(d+l)+(l-R),x=v+d,l=x-v,_=v-(x-l)+(d-l),d=_-w,l=_-d,M[1]=_-(d+l)+(l-w),b=x+d,l=b-x,M[2]=x-(b-l)+(d-l),M[3]=b;const Lt=H(Pt,ct,4,M,ft);v=o*p,c=S*o,f=c-(c-o),y=o-f,c=S*p,g=c-(c-p),m=p-g,E=y*m-(v-f*g-y*g-f*m),w=a*h,c=S*a,f=c-(c-a),y=a-f,c=S*h,g=c-(c-h),m=h-g,R=y*m-(w-f*g-y*g-f*m),d=E-R,l=E-d,M[0]=E-(d+l)+(l-R),x=v+d,l=x-v,_=v-(x-l)+(d-l),d=_-w,l=_-d,M[1]=_-(d+l)+(l-w),b=x+d,l=b-x,M[2]=x-(b-l)+(d-l),M[3]=b;const Rt=H(Lt,ft,4,M,pt);return pt[Rt-1]}function Xt(i,t,e,n,s,r){const u=(t-r)*(e-s),o=(i-s)*(n-r),a=u-o,h=Math.abs(u+o);return Math.abs(a)>=jt*h?a:-Yt(i,t,e,n,s,r,h)}const j=(i,t)=>i.ll.x<=t.x&&t.x<=i.ur.x&&i.ll.y<=t.y&&t.y<=i.ur.y,rt=(i,t)=>{if(t.ur.x<i.ll.x||i.ur.x<t.ll.x||t.ur.y<i.ll.y||i.ur.y<t.ll.y)return null;const e=i.ll.x<t.ll.x?t.ll.x:i.ll.x,n=i.ur.x<t.ur.x?i.ur.x:t.ur.x,s=i.ll.y<t.ll.y?t.ll.y:i.ll.y,r=i.ur.y<t.ur.y?i.ur.y:t.ur.y;return{ll:{x:e,y:s},ur:{x:n,y:r}}};let B=Number.EPSILON;B===void 0&&(B=Math.pow(2,-52));const Vt=B*B,gt=(i,t)=>{if(-B<i&&i<B&&-B<t&&t<B)return 0;const e=i-t;return e*e<Vt*i*t?0:i<t?-1:1};class Jt{constructor(){this.reset()}reset(){this.xRounder=new yt,this.yRounder=new yt}round(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}class yt{constructor(){this.tree=new lt,this.round(0)}round(t){const e=this.tree.add(t),n=this.tree.prev(e);if(n!==null&&gt(e.key,n.key)===0)return this.tree.remove(t),n.key;const s=this.tree.next(e);return s!==null&&gt(e.key,s.key)===0?(this.tree.remove(t),s.key):t}}const q=new Jt,Y=(i,t)=>i.x*t.y-i.y*t.x,St=(i,t)=>i.x*t.x+i.y*t.y,dt=(i,t,e)=>{const n=Xt(i.x,i.y,t.x,t.y,e.x,e.y);return n>0?-1:n<0?1:0},V=i=>Math.sqrt(St(i,i)),Zt=(i,t,e)=>{const n={x:t.x-i.x,y:t.y-i.y},s={x:e.x-i.x,y:e.y-i.y};return Y(s,n)/V(s)/V(n)},Wt=(i,t,e)=>{const n={x:t.x-i.x,y:t.y-i.y},s={x:e.x-i.x,y:e.y-i.y};return St(s,n)/V(s)/V(n)},mt=(i,t,e)=>t.y===0?null:{x:i.x+t.x/t.y*(e-i.y),y:e},xt=(i,t,e)=>t.x===0?null:{x:e,y:i.y+t.y/t.x*(e-i.x)},Ht=(i,t,e,n)=>{if(t.x===0)return xt(e,n,i.x);if(n.x===0)return xt(i,t,e.x);if(t.y===0)return mt(e,n,i.y);if(n.y===0)return mt(i,t,e.y);const s=Y(t,n);if(s==0)return null;const r={x:e.x-i.x,y:e.y-i.y},u=Y(r,t)/s,o=Y(r,n)/s,a=i.x+o*t.x,h=e.x+u*n.x,p=i.y+o*t.y,l=e.y+u*n.y,c=(a+h)/2,f=(p+l)/2;return{x:c,y:f}};class I{static compare(t,e){const n=I.comparePoints(t.point,e.point);return n!==0?n:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:T.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}constructor(t,e){t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let n=0,s=e.length;n<s;n++){const r=e[n];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const n=this.point.events[e];if(n.segment.consumedBy===void 0)for(let s=e+1;s<t;s++){const r=this.point.events[s];r.consumedBy===void 0&&n.otherSE.point.events===r.otherSE.point.events&&n.segment.consume(r.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,n=this.point.events.length;e<n;e++){const s=this.point.events[e];s!==this&&!s.segment.ringOut&&s.segment.isInResult()&&t.push(s)}return t}getLeftmostComparator(t){const e=new Map,n=s=>{const r=s.otherSE;e.set(s,{sine:Zt(this.point,t.point,r.point),cosine:Wt(this.point,t.point,r.point)})};return(s,r)=>{e.has(s)||n(s),e.has(r)||n(r);const{sine:u,cosine:o}=e.get(s),{sine:a,cosine:h}=e.get(r);return u>=0&&a>=0?o<h?1:o>h?-1:0:u<0&&a<0?o<h?-1:o>h?1:0:a<u?-1:a>u?1:0}}}let Kt=0;class T{static compare(t,e){const n=t.leftSE.point.x,s=e.leftSE.point.x,r=t.rightSE.point.x,u=e.rightSE.point.x;if(u<n)return 1;if(r<s)return-1;const o=t.leftSE.point.y,a=e.leftSE.point.y,h=t.rightSE.point.y,p=e.rightSE.point.y;if(n<s){if(a<o&&a<h)return 1;if(a>o&&a>h)return-1;const l=t.comparePoint(e.leftSE.point);if(l<0)return 1;if(l>0)return-1;const c=e.comparePoint(t.rightSE.point);return c!==0?c:-1}if(n>s){if(o<a&&o<p)return-1;if(o>a&&o>p)return 1;const l=e.comparePoint(t.leftSE.point);if(l!==0)return l;const c=t.comparePoint(e.rightSE.point);return c<0?1:c>0?-1:1}if(o<a)return-1;if(o>a)return 1;if(r<u){const l=e.comparePoint(t.rightSE.point);if(l!==0)return l}if(r>u){const l=t.comparePoint(e.rightSE.point);if(l<0)return 1;if(l>0)return-1}if(r!==u){const l=h-o,c=r-n,f=p-a,y=u-s;if(l>c&&f<y)return 1;if(l<c&&f>y)return-1}return r>u?1:r<u||h<p?-1:h>p?1:t.id<e.id?-1:t.id>e.id?1:0}constructor(t,e,n,s){this.id=++Kt,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=n,this.windings=s}static fromRing(t,e,n){let s,r,u;const o=I.comparePoints(t,e);if(o<0)s=t,r=e,u=1;else if(o>0)s=e,r=t,u=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const a=new I(s,!0),h=new I(r,!1);return new T(a,h,[n],[u])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const e=this.leftSE.point,n=this.rightSE.point,s=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;const r=(t.y-e.y)/s.y,u=e.x+r*s.x;if(t.x===u)return 0;const o=(t.x-e.x)/s.x,a=e.y+o*s.y;return t.y===a?0:t.y<a?-1:1}getIntersection(t){const e=this.bbox(),n=t.bbox(),s=rt(e,n);if(s===null)return null;const r=this.leftSE.point,u=this.rightSE.point,o=t.leftSE.point,a=t.rightSE.point,h=j(e,o)&&this.comparePoint(o)===0,p=j(n,r)&&t.comparePoint(r)===0,l=j(e,a)&&this.comparePoint(a)===0,c=j(n,u)&&t.comparePoint(u)===0;if(p&&h)return c&&!l?u:!c&&l?a:null;if(p)return l&&r.x===a.x&&r.y===a.y?null:r;if(h)return c&&u.x===o.x&&u.y===o.y?null:o;if(c&&l)return null;if(c)return u;if(l)return a;const f=Ht(r,this.vector(),o,t.vector());return f===null||!j(s,f)?null:q.round(f.x,f.y)}split(t){const e=[],n=t.events!==void 0,s=new I(t,!0),r=new I(t,!1),u=this.rightSE;this.replaceRightSE(r),e.push(r),e.push(s);const o=new T(s,u,this.rings.slice(),this.windings.slice());return I.comparePoints(o.leftSE.point,o.rightSE.point)>0&&o.swapEvents(),I.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(s.checkForConsuming(),r.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}consume(t){let e=this,n=t;for(;e.consumedBy;)e=e.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const s=T.compare(e,n);if(s!==0){if(s>0){const r=e;e=n,n=r}if(e.prev===n){const r=e;e=n,n=r}for(let r=0,u=n.rings.length;r<u;r++){const o=n.rings[r],a=n.windings[r],h=e.rings.indexOf(o);h===-1?(e.rings.push(o),e.windings.push(a)):e.windings[h]+=a}n.rings=null,n.windings=null,n.consumedBy=e,n.leftSE.consumedBy=e.leftSE,n.rightSE.consumedBy=e.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,n=this._afterState.windings,s=this._afterState.multiPolys;for(let o=0,a=this.rings.length;o<a;o++){const h=this.rings[o],p=this.windings[o],l=e.indexOf(h);l===-1?(e.push(h),n.push(p)):n[l]+=p}const r=[],u=[];for(let o=0,a=e.length;o<a;o++){if(n[o]===0)continue;const h=e[o],p=h.poly;if(u.indexOf(p)===-1)if(h.isExterior)r.push(p);else{u.indexOf(p)===-1&&u.push(p);const l=r.indexOf(h.poly);l!==-1&&r.splice(l,1)}}for(let o=0,a=r.length;o<a;o++){const h=r[o].multiPoly;s.indexOf(h)===-1&&s.push(h)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(C.type){case"union":{const n=t.length===0,s=e.length===0;this._isInResult=n!==s;break}case"intersection":{let n,s;t.length<e.length?(n=t.length,s=e.length):(n=e.length,s=t.length),this._isInResult=s===C.numMultiPolys&&n<s;break}case"xor":{const n=Math.abs(t.length-e.length);this._isInResult=n%2===1;break}case"difference":{const n=s=>s.length===1&&s[0].isSubject;this._isInResult=n(t)!==n(e);break}default:throw new Error(`Unrecognized operation type found ${C.type}`)}return this._isInResult}}class vt{constructor(t,e,n){if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=n,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const s=q.round(t[0][0],t[0][1]);this.bbox={ll:{x:s.x,y:s.y},ur:{x:s.x,y:s.y}};let r=s;for(let u=1,o=t.length;u<o;u++){if(typeof t[u][0]!="number"||typeof t[u][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let a=q.round(t[u][0],t[u][1]);a.x===r.x&&a.y===r.y||(this.segments.push(T.fromRing(r,a,this)),a.x<this.bbox.ll.x&&(this.bbox.ll.x=a.x),a.y<this.bbox.ll.y&&(this.bbox.ll.y=a.y),a.x>this.bbox.ur.x&&(this.bbox.ur.x=a.x),a.y>this.bbox.ur.y&&(this.bbox.ur.y=a.y),r=a)}(s.x!==r.x||s.y!==r.y)&&this.segments.push(T.fromRing(r,s,this))}getSweepEvents(){const t=[];for(let e=0,n=this.segments.length;e<n;e++){const s=this.segments[e];t.push(s.leftSE),t.push(s.rightSE)}return t}}class te{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new vt(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,s=t.length;n<s;n++){const r=new vt(t[n],this,!1);r.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=r.bbox.ur.y),this.interiorRings.push(r)}this.multiPoly=e}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let e=0,n=this.interiorRings.length;e<n;e++){const s=this.interiorRings[e].getSweepEvents();for(let r=0,u=s.length;r<u;r++)t.push(s[r])}return t}}class _t{constructor(t,e){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let n=0,s=t.length;n<s;n++){const r=new te(t[n],this);r.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=r.bbox.ll.x),r.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=r.bbox.ll.y),r.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=r.bbox.ur.x),r.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=r.bbox.ur.y),this.polys.push(r)}this.isSubject=e}getSweepEvents(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const s=this.polys[e].getSweepEvents();for(let r=0,u=s.length;r<u;r++)t.push(s[r])}return t}}class J{static factory(t){const e=[];for(let n=0,s=t.length;n<s;n++){const r=t[n];if(!r.isInResult()||r.ringOut)continue;let u=null,o=r.leftSE,a=r.rightSE;const h=[o],p=o.point,l=[];for(;u=o,o=a,h.push(o),o.point!==p;)for(;;){const c=o.getAvailableLinkedEvents();if(c.length===0){const g=h[0].point,m=h[h.length-1].point;throw new Error(`Unable to complete output ring starting at [${g.x}, ${g.y}]. Last matching segment found ends at [${m.x}, ${m.y}].`)}if(c.length===1){a=c[0].otherSE;break}let f=null;for(let g=0,m=l.length;g<m;g++)if(l[g].point===o.point){f=g;break}if(f!==null){const g=l.splice(f)[0],m=h.splice(g.index);m.unshift(m[0].otherSE),e.push(new J(m.reverse()));continue}l.push({index:h.length,point:o.point});const y=o.getLeftmostComparator(u);a=c.sort(y)[0].otherSE;break}e.push(new J(h))}return e}constructor(t){this.events=t;for(let e=0,n=t.length;e<n;e++)t[e].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const e=[t];for(let h=1,p=this.events.length-1;h<p;h++){const l=this.events[h].point,c=this.events[h+1].point;dt(l,t,c)!==0&&(e.push(l),t=l)}if(e.length===1)return null;const n=e[0],s=e[1];dt(n,t,s)===0&&e.shift(),e.push(e[0]);const r=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,o=this.isExteriorRing()?e.length:-1,a=[];for(let h=u;h!=o;h+=r)a.push([e[h].x,e[h].y]);return a}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let s=1,r=this.events.length;s<r;s++){const u=this.events[s];I.compare(t,u)>0&&(t=u)}let e=t.segment.prevInResult(),n=e?e.prevInResult():null;for(;;){if(!e)return null;if(!n)return e.ringOut;if(n.ringOut!==e.ringOut)return n.ringOut.enclosingRing()!==e.ringOut?e.ringOut:e.ringOut.enclosingRing();e=n.prevInResult(),n=e?e.prevInResult():null}}}class Et{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let e=0,n=this.interiorRings.length;e<n;e++){const s=this.interiorRings[e].getGeom();s!==null&&t.push(s)}return t}}class ee{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let e=0,n=this.polys.length;e<n;e++){const s=this.polys[e].getGeom();s!==null&&t.push(s)}return t}_composePolys(t){const e=[];for(let n=0,s=t.length;n<s;n++){const r=t[n];if(!r.poly)if(r.isExteriorRing())e.push(new Et(r));else{const u=r.enclosingRing();u.poly||e.push(new Et(u)),u.poly.addInterior(r)}}return e}}class ne{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:T.compare;this.queue=t,this.tree=new lt(e),this.segments=[]}process(t){const e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;const s=t.isLeft?this.tree.add(e):this.tree.find(e);if(!s)throw new Error(`Unable to find segment #${e.id} [${e.leftSE.point.x}, ${e.leftSE.point.y}] -> [${e.rightSE.point.x}, ${e.rightSE.point.y}] in SweepLine tree.`);let r=s,u=s,o,a;for(;o===void 0;)r=this.tree.prev(r),r===null?o=null:r.key.consumedBy===void 0&&(o=r.key);for(;a===void 0;)u=this.tree.next(u),u===null?a=null:u.key.consumedBy===void 0&&(a=u.key);if(t.isLeft){let h=null;if(o){const l=o.getIntersection(e);if(l!==null&&(e.isAnEndpoint(l)||(h=l),!o.isAnEndpoint(l))){const c=this._splitSafely(o,l);for(let f=0,y=c.length;f<y;f++)n.push(c[f])}}let p=null;if(a){const l=a.getIntersection(e);if(l!==null&&(e.isAnEndpoint(l)||(p=l),!a.isAnEndpoint(l))){const c=this._splitSafely(a,l);for(let f=0,y=c.length;f<y;f++)n.push(c[f])}}if(h!==null||p!==null){let l=null;h===null?l=p:p===null?l=h:l=I.comparePoints(h,p)<=0?h:p,this.queue.remove(e.rightSE),n.push(e.rightSE);const c=e.split(l);for(let f=0,y=c.length;f<y;f++)n.push(c[f])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=o)}else{if(o&&a){const h=o.getIntersection(a);if(h!==null){if(!o.isAnEndpoint(h)){const p=this._splitSafely(o,h);for(let l=0,c=p.length;l<c;l++)n.push(p[l])}if(!a.isAnEndpoint(h)){const p=this._splitSafely(a,h);for(let l=0,c=p.length;l<c;l++)n.push(p[l])}}}this.tree.remove(e)}return n}_splitSafely(t,e){this.tree.remove(t);const n=t.rightSE;this.queue.remove(n);const s=t.split(e);return s.push(n),t.consumedBy===void 0&&this.tree.add(t),s}}const wt=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,ie=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class re{run(t,e,n){C.type=t,q.reset();const s=[new _t(e,!0)];for(let l=0,c=n.length;l<c;l++)s.push(new _t(n[l],!1));if(C.numMultiPolys=s.length,C.type==="difference"){const l=s[0];let c=1;for(;c<s.length;)rt(s[c].bbox,l.bbox)!==null?c++:s.splice(c,1)}if(C.type==="intersection")for(let l=0,c=s.length;l<c;l++){const f=s[l];for(let y=l+1,g=s.length;y<g;y++)if(rt(f.bbox,s[y].bbox)===null)return[]}const r=new lt(I.compare);for(let l=0,c=s.length;l<c;l++){const f=s[l].getSweepEvents();for(let y=0,g=f.length;y<g;y++)if(r.insert(f[y]),r.size>wt)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const u=new ne(r);let o=r.size,a=r.pop();for(;a;){const l=a.key;if(r.size===o){const f=l.segment;throw new Error(`Unable to pop() ${l.isLeft?"left":"right"} SweepEvent [${l.point.x}, ${l.point.y}] from segment #${f.id} [${f.leftSE.point.x}, ${f.leftSE.point.y}] -> [${f.rightSE.point.x}, ${f.rightSE.point.y}] from queue.`)}if(r.size>wt)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(u.segments.length>ie)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const c=u.process(l);for(let f=0,y=c.length;f<y;f++){const g=c[f];g.consumedBy===void 0&&r.insert(g)}o=r.size,a=r.pop()}q.reset();const h=J.factory(u.segments);return new ee(h).getGeom()}}const C=new re,se=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return C.run("union",i,e)},oe=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return C.run("intersection",i,e)},le=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return C.run("xor",i,e)},ue=function(i){for(var t=arguments.length,e=new Array(t>1?t-1:0),n=1;n<t;n++)e[n-1]=arguments[n];return C.run("difference",i,e)};var Mt={union:se,intersection:oe,xor:le,difference:ue};function he(i,t,e){e===void 0&&(e={});var n=X(i),s=X(t),r=Mt.union(n.coordinates,s.coordinates);return r.length===0?null:r.length===1?ot(r[0],e.properties):bt(r,e.properties)}function ae(i,t){var e=X(i),n=X(t),s=i.properties||{},r=Mt.difference(e.coordinates,n.coordinates);return r.length===0?null:r.length===1?ot(r[0],s):bt(r,s)}let K={circle:Ct,union:he,difference:ae};const ce=L.Control.extend({options:{position:"topright",radius:30,minRadius:10,maxRadius:50,layerOptions:{weight:1},drawOptions:{weight:1,opacity:.75},eraseOptions:{color:"#ff324a",weight:.4},menu:{drawErase:!0,size:!0,eraseAll:!0},initData:()=>{},drawCallback:()=>{},selectEraser:()=>{}},_latlng:[0,0],_metersPerPixel:{},onAdd:function(i){return this._map=i,this.setRadius(this.options.radius),this.options.menu===!1?L.DomUtil.create("div"):(this._container=L.DomUtil.create("div","leaflet-control-paintpolygon leaflet-bar leaflet-control"),this._createMenu(),this.options.selectEraser?this._clickErase("click"):this._clickDraw("click"),this._data=this.options.initData(),this._data&&this._iconEraseAll.classList.remove("leaflet-disabled"),this._container)},onRemove:function(){this._resetMenu(),this.stop(),this._data&&this._map.removeLayer(this._data),this._map.off("mousemove",this._onMouseMove,this)},setRadius:function(i){i!==void 0&&(i<this.options.minRadius?this._radius=this.options.minRadius:i>this.options.maxRadius?this._radius=this.options.maxRadius:this._radius=i),this._circle&&this._circle.setRadius(this._radius)},startDraw:function(){this.stop(),this._action="draw",this._addMouseListener(),this._circle=L.circleMarker(this._latlng,this.options.drawOptions).setRadius(this._radius).addTo(this._map)},startErase:function(){this.stop(),this._action="erase",this._addMouseListener(),this._circle=L.circleMarker(this._latlng,this.options.eraseOptions).setRadius(this._radius).addTo(this._map)},stop:function(){this._action=null,this._circle&&this._circle.remove(),this._removeMouseListener()},getLayer:function(){return this._layer},setData:function(i){this._iconEraseAll.classList.remove("leaflet-disabled"),this.options.drawCallback(i),this._data=i},eraseAll:function(){this.setData()},_createMenu:function(){if(this.options.menu.drawErase!==!1&&(this._iconDraw=L.DomUtil.create("a","leaflet-control-paintpolygon-icon leaflet-control-paintpolygon-icon-brush",this._container),this._iconErase=L.DomUtil.create("a","leaflet-control-paintpolygon-icon leaflet-control-paintpolygon-icon-eraser",this._container),L.DomEvent.on(this._iconDraw,"click mousedown",this._clickDraw,this),L.DomEvent.on(this._iconErase,"click mousedown",this._clickErase,this),L.DomEvent.on(this._container,"dblclick",this._stopEventPropagation,this)),this.options.menu.size!==!1){this._iconSize=L.DomUtil.create("a","leaflet-control-paintpolygon-icon leaflet-control-paintpolygon-icon-size",this._container),this._menu=L.DomUtil.create("div","leaflet-bar leaflet-control-paintpolygon-menu",this._container),L.DomEvent.disableClickPropagation(this._menu);var i=L.DomUtil.create("div","leaflet-control-paintpolygon-menu-content",this._menu),t=L.DomUtil.create("input","",i);t.type="range",t.value=this._radius,t.min=this.options.minRadius,t.max=this.options.maxRadius,L.DomEvent.on(t,"input change",this._cursorMove,this),L.DomEvent.on(this._iconSize,"click mousedown",this._clickSize,this)}this.options.menu.eraseAll!==!1&&(this._iconEraseAll=L.DomUtil.create("a","leaflet-control-paintpolygon-icon leaflet-control-paintpolygon-icon-trash leaflet-disabled",this._container),L.DomEvent.on(this._iconEraseAll,"click mousedown",this._clickEraseAll,this))},_stopEventPropagation:function(i){if(i.type=="dblclick"){i.stopPropagation();return}},_clickDraw:function(i){if(L.DomUtil.hasClass(this._menu,"leaflet-control-paintpolygon-menu-open")&&this._closeMenu(),i.type=="mousedown"){L.DomEvent.stop(i);return}this._resetMenu(),this._action=="draw"?this.stop():(this.startDraw(),this._activeIconStyle(this._iconDraw))},_clickErase:function(i){if(L.DomUtil.hasClass(this._menu,"leaflet-control-paintpolygon-menu-open")&&this._closeMenu(),i.type=="mousedown"){L.DomEvent.stop(i);return}this._resetMenu(),this._action=="erase"?this.stop():(this.startErase(),this._activeIconStyle(this._iconErase))},_clickSize:function(i){if(i.type=="mousedown"){L.DomEvent.stop(i);return}L.DomUtil.hasClass(this._menu,"leaflet-control-paintpolygon-menu-open")?this._closeMenu():this._openMenu()},_clickEraseAll:function(i){if(L.DomUtil.hasClass(this._menu,"leaflet-control-paintpolygon-menu-open")&&this._closeMenu(),i.type=="mousedown"){L.DomEvent.stop(i);return}this.eraseAll(),this._iconEraseAll.classList.add("leaflet-disabled")},_resetMenu:function(){L.DomUtil.removeClass(this._iconDraw,"leaflet-control-paintpolygon-icon-active"),L.DomUtil.removeClass(this._iconErase,"leaflet-control-paintpolygon-icon-active")},_activeIconStyle:function(i){L.DomUtil.addClass(i,"leaflet-control-paintpolygon-icon-active")},_openMenu:function(){L.DomUtil.addClass(this._menu,"leaflet-control-paintpolygon-menu-open")},_closeMenu:function(){L.DomUtil.removeClass(this._menu,"leaflet-control-paintpolygon-menu-open")},_cursorMove:function(i){this.setRadius(i.target.valueAsNumber)},_addMouseListener:function(){this._map.on("mousemove",this._onMouseMove,this),this._map.on("mousedown",this._onMouseDown,this),this._map.on("mouseup",this._onMouseUp,this)},_removeMouseListener:function(){this._map.off("mousemove",this._onMouseMove,this),this._map.off("mousedown",this._onMouseDown,this),this._map.off("mouseup",this._onMouseUp,this)},_onMouseDown:function(i){L.DomUtil.hasClass(this._menu,"leaflet-control-paintpolygon-menu-open")&&this._closeMenu(),this._map.dragging.disable(),this._mousedown=!0,this._onMouseMove(i)},_onMouseUp:function(i){this._map.dragging.enable(),this._mousedown=!1},_onMouseMove:function(i){this._setLatLng(i.latlng),this._mousedown===!0&&this._stackEvt(i.latlng,this._map.getZoom(),this._radius,this._action)},_setLatLng:function(i){i!==void 0&&(this._latlng=i),this._circle&&this._circle.setLatLng(this._latlng)},_latLngAsGeoJSON:function(i){return{type:"Point",coordinates:[i.lng,i.lat]}},_getCircleAsPolygon:function(i,t,e){var n=i.lat;return this._metersPerPixel[t]===void 0&&(this._metersPerPixel[t]=40075016686e-3*Math.abs(Math.cos(n*Math.PI/180))/Math.pow(2,t+8)),K.circle(this._latLngAsGeoJSON(i),this._metersPerPixel[t]*e/1e3)},_draw:function(i,t,e){if(this._data===void 0||this._data===null)this.setData(this._getCircleAsPolygon(i,t,e));else{const n=this._data,s=this._getCircleAsPolygon(i,t,e);this.setData(K.union(n,s))}},_erase:function(i,t,e){this._data===void 0||this._data===null||this.setData(K.difference(this._data,this._getCircleAsPolygon(i,t,e)))},_stackEvt:function(i,t,e,n){this._stack===void 0&&(this._stack=new Array),this._stack.push({latlng:i,zoom:t,radius:e,action:n}),this._processStack()},_processStack:function(){if(!(this._processingStack===!0||this._stack.length==0)){this._processingStack=!0;var i=this._stack.shift();i.action=="draw"?this._draw(i.latlng,i.zoom,i.radius):i.action=="erase"&&this._erase(i.latlng,i.zoom,i.radius),this._processingStack=!1,this._processStack()}}});L.Control.PaintPolygon=ce;L.control.paintPolygon=i=>new L.Control.PaintPolygon(i);export{ce as default};
